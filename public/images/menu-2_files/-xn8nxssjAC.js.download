;/*FB_PKG_DELIM*/

__d("Hpke",["$InternalEnum","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i){"use strict";var e=new Uint8Array([0]),l=new TextEncoder,s=l.encode("psk_id_hash"),u=l.encode("info_hash"),c=l.encode("secret"),d=l.encode("key"),m=l.encode("base_nonce"),p=l.encode("exp"),_=l.encode("HPKE"),f=l.encode("sec"),g=n("$InternalEnum")({KemX25519HkdfSha256Id:32}),h=n("$InternalEnum")({KdfHkdfSha256Id:1}),y=n("$InternalEnum")({AeadAes128GcmId:1,AeadChaCha20Poly1305Id:3}),C=(function(){function t(e,t,n){this.kem=e,this.kdf=t,this.aead=n}var r=t.prototype;return r.setupBaseS=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.kem.encap(e),r=yield this.keySchedule(n.sharedSecret,t);return{enc:n.enc,ctx:r}});function t(t,n){return e.apply(this,arguments)}return t})(),r.setupBaseR=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=yield this.kem.decap(e,t),o=yield this.keySchedule(r,n);return o});function t(t,n,r){return e.apply(this,arguments)}return t})(),r.keySchedule=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r=R(this.kem.kem_id,this.kdf.kdf_id,this.aead.aead_id),o=yield this.kdf.labeledExtract(new Uint8Array(0),s,new Uint8Array(0),r),a=yield this.kdf.labeledExtract(new Uint8Array(0),u,n,r),i=v(e,o,a),l=yield this.kdf.labeledExtract(t,c,new Uint8Array(0),r),_=yield this.kdf.labeledExpand(l,d,i,this.aead.nK,r),f=yield this.kdf.labeledExpand(l,m,i,this.aead.nN,r),g=yield this.kdf.labeledExpand(l,p,i,this.kdf.nH,r);return new b(_,f,b.defaultSeq(this.aead.nN),g,this.aead,this.kdf,r)});function r(e,n){return t.apply(this,arguments)}return r})(),r.sealSingleShot=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var o=yield this.setupBaseS(e,t),a=yield o.ctx.seal(n,r);return{ct:a,enc:o.enc}});function t(t,n,r,o){return e.apply(this,arguments)}return t})(),r.openSingleShot=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,o){var a=yield this.setupBaseR(e,t,n),i=a.open(r,o);return i});function t(t,n,r,o,a){return e.apply(this,arguments)}return t})(),t})(),b=(function(){function e(e,t,n,r,o,a,i){this.key=e,this.base_nonce=t,this.seq=n,this.exporter_secret=r,this.aead=o,this.kdf=a,this.suite_id=i}e.defaultSeq=function(t){return new Uint8Array(t).fill(0)};var t=e.prototype;return t.seal=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.aead.seal(this.key,this.computeNonce(),e,t);return this.incrementSeq(),n});function t(t,n){return e.apply(this,arguments)}return t})(),t.open=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.aead.open(this.key,this.computeNonce(),e,t);return this.incrementSeq(),n});function t(t,n){return e.apply(this,arguments)}return t})(),t.computeNonce=function(){return L(this.base_nonce,this.seq)},t.incrementSeq=function(){for(var e=!1,t=this.seq.byteLength-1;t>=0&&!e;t--)this.seq[t]!==255?(this.seq[t]+=1,e=!0):this.seq[t]=0},t.setSeq=function(t){this.seq=t},t.export=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.kdf.labeledExpand(this.exporter_secret,f,e,t,this.suite_id);return n});function t(t,n){return e.apply(this,arguments)}return t})(),e})();function v(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach(function(t){return e+=t.byteLength});var o=new Uint8Array(e),a=0;return n.forEach(function(e){o.set(e,a),a+=e.byteLength}),o}function S(e,t){for(var n=new Uint8Array(t),r=e,o=0;o<t&&r;o++)n[t-(o+1)]=r%256,r>>=8;return n}function R(e,t,n){var r=v(_,S(e,2),S(t,2),S(n,2));return r}function L(e,t){if(e.byteLength!==t.byteLength){var n=new Error("Xor: different length inputs");throw n.stack,n}for(var r=new Uint8Array(e.byteLength),o=0;o<e.byteLength;o++)r[o]=e[o]^t[o];return r}i.KemID=g,i.KdfID=h,i.AeadID=y,i.Hpke=C,i.HpkeCtx=b,i.concat=v,i.i2osp=S,i.hpkeSuiteId=R,i.xor=L}),66);
__d("AeadAes128Gcm",["Hpke","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e=window.crypto||window.msCrypto,s=(function(){function t(t){t===void 0&&(t=e.subtle),this.aead_id=o("Hpke").AeadID.AeadAes128GcmId,this.nK=16,this.nN=12,this.nT=16,this.internalCryptoProvider=null,this.internalCryptoProvider=t}var r=t.prototype;return r.seal=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var o=yield this.internalCryptoProvider.importKey("raw",e,{name:"AES-GCM"},!0,["encrypt"]),a={name:"AES-GCM",iv:t,additionalData:n},i=yield this.internalCryptoProvider.encrypt(a,o,r);return new Uint8Array(i)});function t(t,n,r,o){return e.apply(this,arguments)}return t})(),r.open=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var o=yield this.internalCryptoProvider.importKey("raw",e,{name:"AES-GCM"},!0,["decrypt"]),a={name:"AES-GCM",iv:t,additionalData:n},i=yield this.internalCryptoProvider.decrypt(a,o,r);return new Uint8Array(i)});function t(t,n,r,o){return e.apply(this,arguments)}return t})(),t})();l.AeadAes128Gcm=s}),98);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-int-1.0.1",[],(function(t,n,r,o,a,i){"use strict";var e={},l={exports:e};function s(){Object.defineProperty(e,"__esModule",{value:!0});function t(e,t){var n=e>>>16&65535,r=e&65535,o=t>>>16&65535,a=t&65535;return r*a+(n*a+r*o<<16>>>0)|0}e.mul=Math.imul||t;function n(e,t){return e+t|0}e.add=n;function r(e,t){return e-t|0}e.sub=r;function o(e,t){return e<<t|e>>>32-t}e.rotl=o;function a(e,t){return e<<32-t|e>>>t}e.rotr=a;function i(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}e.isInteger=Number.isInteger||i,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(t){return e.isInteger(t)&&t>=-e.MAX_SAFE_INTEGER&&t<=e.MAX_SAFE_INTEGER}}var u=!1;function c(){return u||(u=!0,s()),l.exports}function d(e){switch(e){case void 0:return c()}}a.exports=d}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-binary-1.0.1",["stablelib-int-1.0.1"],(function(t,n,r,o,a,i){"use strict";function e(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var l=e(n("stablelib-int-1.0.1")),s={},u={exports:s};function c(){Object.defineProperty(s,"__esModule",{value:!0});var e=l();function t(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}s.readInt16BE=t;function n(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}s.readUint16BE=n;function r(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}s.readInt16LE=r;function o(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}s.readUint16LE=o;function a(e,t,n){return t===void 0&&(t=new Uint8Array(2)),n===void 0&&(n=0),t[n+0]=e>>>8,t[n+1]=e>>>0,t}s.writeUint16BE=a,s.writeInt16BE=a;function i(e,t,n){return t===void 0&&(t=new Uint8Array(2)),n===void 0&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t}s.writeUint16LE=i,s.writeInt16LE=i;function u(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}s.readInt32BE=u;function c(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}s.readUint32BE=c;function d(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}s.readInt32LE=d;function m(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}s.readUint32LE=m;function p(e,t,n){return t===void 0&&(t=new Uint8Array(4)),n===void 0&&(n=0),t[n+0]=e>>>24,t[n+1]=e>>>16,t[n+2]=e>>>8,t[n+3]=e>>>0,t}s.writeUint32BE=p,s.writeInt32BE=p;function _(e,t,n){return t===void 0&&(t=new Uint8Array(4)),n===void 0&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24,t}s.writeUint32LE=_,s.writeInt32LE=_;function f(e,t){t===void 0&&(t=0);var n=u(e,t),r=u(e,t+4);return n*4294967296+r-(r>>31)*4294967296}s.readInt64BE=f;function g(e,t){t===void 0&&(t=0);var n=c(e,t),r=c(e,t+4);return n*4294967296+r}s.readUint64BE=g;function h(e,t){t===void 0&&(t=0);var n=d(e,t),r=d(e,t+4);return r*4294967296+n-(n>>31)*4294967296}s.readInt64LE=h;function y(e,t){t===void 0&&(t=0);var n=m(e,t),r=m(e,t+4);return r*4294967296+n}s.readUint64LE=y;function C(e,t,n){return t===void 0&&(t=new Uint8Array(8)),n===void 0&&(n=0),p(e/4294967296>>>0,t,n),p(e>>>0,t,n+4),t}s.writeUint64BE=C,s.writeInt64BE=C;function b(e,t,n){return t===void 0&&(t=new Uint8Array(8)),n===void 0&&(n=0),_(e>>>0,t,n),_(e/4294967296>>>0,t,n+4),t}s.writeUint64LE=b,s.writeInt64LE=b;function v(e,t,n){if(n===void 0&&(n=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintBE: array is too short for the given bitLength");for(var r=0,o=1,a=e/8+n-1;a>=n;a--)r+=t[a]*o,o*=256;return r}s.readUintBE=v;function S(e,t,n){if(n===void 0&&(n=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintLE: array is too short for the given bitLength");for(var r=0,o=1,a=n;a<n+e/8;a++)r+=t[a]*o,o*=256;return r}s.readUintLE=S;function R(t,n,r,o){if(r===void 0&&(r=new Uint8Array(t/8)),o===void 0&&(o=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!e.isSafeInteger(n))throw new Error("writeUintBE value must be an integer");for(var a=1,i=t/8+o-1;i>=o;i--)r[i]=n/a&255,a*=256;return r}s.writeUintBE=R;function L(t,n,r,o){if(r===void 0&&(r=new Uint8Array(t/8)),o===void 0&&(o=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!e.isSafeInteger(n))throw new Error("writeUintLE value must be an integer");for(var a=1,i=o;i<o+t/8;i++)r[i]=n/a&255,a*=256;return r}s.writeUintLE=L;function E(e,t){t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat32(t)}s.readFloat32BE=E;function k(e,t){t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat32(t,!0)}s.readFloat32LE=k;function I(e,t){t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat64(t)}s.readFloat64BE=I;function T(e,t){t===void 0&&(t=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.getFloat64(t,!0)}s.readFloat64LE=T;function D(e,t,n){t===void 0&&(t=new Uint8Array(4)),n===void 0&&(n=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setFloat32(n,e),t}s.writeFloat32BE=D;function x(e,t,n){t===void 0&&(t=new Uint8Array(4)),n===void 0&&(n=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setFloat32(n,e,!0),t}s.writeFloat32LE=x;function $(e,t,n){t===void 0&&(t=new Uint8Array(8)),n===void 0&&(n=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setFloat64(n,e),t}s.writeFloat64BE=$;function P(e,t,n){t===void 0&&(t=new Uint8Array(8)),n===void 0&&(n=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.setFloat64(n,e,!0),t}s.writeFloat64LE=P}var d=!1;function m(){return d||(d=!0,c()),u.exports}function p(e){switch(e){case void 0:return m()}}a.exports=p}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-wipe-1.0.1",[],(function(t,n,r,o,a,i){"use strict";var e={},l={exports:e};function s(){Object.defineProperty(e,"__esModule",{value:!0});function t(e){for(var t=0;t<e.length;t++)e[t]=0;return e}e.wipe=t}var u=!1;function c(){return u||(u=!0,s()),l.exports}function d(e){switch(e){case void 0:return c()}}a.exports=d}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-chacha-1.0.1",["stablelib-binary-1.0.1","stablelib-wipe-1.0.1"],(function(t,n,r,o,a,i){"use strict";function e(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var l=e(n("stablelib-binary-1.0.1")),s=e(n("stablelib-wipe-1.0.1")),u={},c={exports:u};function d(){Object.defineProperty(u,"__esModule",{value:!0});var e=l(),t=s(),n=20;function r(t,r,o){for(var a=1634760805,i=857760878,l=2036477234,s=1797285236,u=o[3]<<24|o[2]<<16|o[1]<<8|o[0],c=o[7]<<24|o[6]<<16|o[5]<<8|o[4],d=o[11]<<24|o[10]<<16|o[9]<<8|o[8],m=o[15]<<24|o[14]<<16|o[13]<<8|o[12],p=o[19]<<24|o[18]<<16|o[17]<<8|o[16],_=o[23]<<24|o[22]<<16|o[21]<<8|o[20],f=o[27]<<24|o[26]<<16|o[25]<<8|o[24],g=o[31]<<24|o[30]<<16|o[29]<<8|o[28],h=r[3]<<24|r[2]<<16|r[1]<<8|r[0],y=r[7]<<24|r[6]<<16|r[5]<<8|r[4],C=r[11]<<24|r[10]<<16|r[9]<<8|r[8],b=r[15]<<24|r[14]<<16|r[13]<<8|r[12],v=a,S=i,R=l,L=s,E=u,k=c,I=d,T=m,D=p,x=_,$=f,P=g,N=h,M=y,w=C,A=b,F=0;F<n;F+=2)v=v+E|0,N^=v,N=N>>>16|N<<16,D=D+N|0,E^=D,E=E>>>20|E<<12,S=S+k|0,M^=S,M=M>>>16|M<<16,x=x+M|0,k^=x,k=k>>>20|k<<12,R=R+I|0,w^=R,w=w>>>16|w<<16,$=$+w|0,I^=$,I=I>>>20|I<<12,L=L+T|0,A^=L,A=A>>>16|A<<16,P=P+A|0,T^=P,T=T>>>20|T<<12,R=R+I|0,w^=R,w=w>>>24|w<<8,$=$+w|0,I^=$,I=I>>>25|I<<7,L=L+T|0,A^=L,A=A>>>24|A<<8,P=P+A|0,T^=P,T=T>>>25|T<<7,S=S+k|0,M^=S,M=M>>>24|M<<8,x=x+M|0,k^=x,k=k>>>25|k<<7,v=v+E|0,N^=v,N=N>>>24|N<<8,D=D+N|0,E^=D,E=E>>>25|E<<7,v=v+k|0,A^=v,A=A>>>16|A<<16,$=$+A|0,k^=$,k=k>>>20|k<<12,S=S+I|0,N^=S,N=N>>>16|N<<16,P=P+N|0,I^=P,I=I>>>20|I<<12,R=R+T|0,M^=R,M=M>>>16|M<<16,D=D+M|0,T^=D,T=T>>>20|T<<12,L=L+E|0,w^=L,w=w>>>16|w<<16,x=x+w|0,E^=x,E=E>>>20|E<<12,R=R+T|0,M^=R,M=M>>>24|M<<8,D=D+M|0,T^=D,T=T>>>25|T<<7,L=L+E|0,w^=L,w=w>>>24|w<<8,x=x+w|0,E^=x,E=E>>>25|E<<7,S=S+I|0,N^=S,N=N>>>24|N<<8,P=P+N|0,I^=P,I=I>>>25|I<<7,v=v+k|0,A^=v,A=A>>>24|A<<8,$=$+A|0,k^=$,k=k>>>25|k<<7;e.writeUint32LE(v+a|0,t,0),e.writeUint32LE(S+i|0,t,4),e.writeUint32LE(R+l|0,t,8),e.writeUint32LE(L+s|0,t,12),e.writeUint32LE(E+u|0,t,16),e.writeUint32LE(k+c|0,t,20),e.writeUint32LE(I+d|0,t,24),e.writeUint32LE(T+m|0,t,28),e.writeUint32LE(D+p|0,t,32),e.writeUint32LE(x+_|0,t,36),e.writeUint32LE($+f|0,t,40),e.writeUint32LE(P+g|0,t,44),e.writeUint32LE(N+h|0,t,48),e.writeUint32LE(M+y|0,t,52),e.writeUint32LE(w+C|0,t,56),e.writeUint32LE(A+b|0,t,60)}function o(e,n,o,a,l){if(l===void 0&&(l=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(a.length<o.length)throw new Error("ChaCha: destination is shorter than source");var s,u;if(l===0){if(n.length!==8&&n.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),u=s.length-n.length,s.set(n,u)}else{if(n.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=n,u=l}for(var c=new Uint8Array(64),d=0;d<o.length;d+=64){r(c,s,e);for(var m=d;m<d+64&&m<o.length;m++)a[m]=o[m]^c[m-d];i(s,0,u)}return t.wipe(c),l===0&&t.wipe(s),a}u.streamXOR=o;function a(e,n,r,a){return a===void 0&&(a=0),t.wipe(r),o(e,n,r,r,a)}u.stream=a;function i(e,t,n){for(var r=1;n--;)r=r+(e[t]&255)|0,e[t]=r&255,r>>>=8,t++;if(r>0)throw new Error("ChaCha: counter overflow")}}var m=!1;function p(){return m||(m=!0,d()),c.exports}function _(e){switch(e){case void 0:return p()}}a.exports=_}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-constant-time-1.0.1",[],(function(t,n,r,o,a,i){"use strict";var e={},l={exports:e};function s(){Object.defineProperty(e,"__esModule",{value:!0});function t(e,t,n){return~(e-1)&t|e-1&n}e.select=t;function n(e,t){return(e|0)-(t|0)-1>>>31&1}e.lessOrEqual=n;function r(e,t){if(e.length!==t.length)return 0;for(var n=0,r=0;r<e.length;r++)n|=e[r]^t[r];return 1&n-1>>>8}e.compare=r;function o(e,t){return e.length===0||t.length===0?!1:r(e,t)!==0}e.equal=o}var u=!1;function c(){return u||(u=!0,s()),l.exports}function d(e){switch(e){case void 0:return c()}}a.exports=d}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-poly1305-1.0.1",["stablelib-constant-time-1.0.1","stablelib-wipe-1.0.1"],(function(t,n,r,o,a,i){"use strict";function e(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var l=e(n("stablelib-constant-time-1.0.1")),s=e(n("stablelib-wipe-1.0.1")),u={},c={exports:u};function d(){Object.defineProperty(u,"__esModule",{value:!0});var e=l(),t=s();u.DIGEST_LENGTH=16;var n=(function(){function e(e){this.digestLength=u.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var t=e[0]|e[1]<<8;this._r[0]=t&8191;var n=e[2]|e[3]<<8;this._r[1]=(t>>>13|n<<3)&8191;var r=e[4]|e[5]<<8;this._r[2]=(n>>>10|r<<6)&7939;var o=e[6]|e[7]<<8;this._r[3]=(r>>>7|o<<9)&8191;var a=e[8]|e[9]<<8;this._r[4]=(o>>>4|a<<12)&255,this._r[5]=a>>>1&8190;var i=e[10]|e[11]<<8;this._r[6]=(a>>>14|i<<2)&8191;var l=e[12]|e[13]<<8;this._r[7]=(i>>>11|l<<5)&8065;var s=e[14]|e[15]<<8;this._r[8]=(l>>>8|s<<8)&8191,this._r[9]=s>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return e.prototype._blocks=function(e,t,n){for(var r=this._fin?0:2048,o=this._h[0],a=this._h[1],i=this._h[2],l=this._h[3],s=this._h[4],u=this._h[5],c=this._h[6],d=this._h[7],m=this._h[8],p=this._h[9],_=this._r[0],f=this._r[1],g=this._r[2],h=this._r[3],y=this._r[4],C=this._r[5],b=this._r[6],v=this._r[7],S=this._r[8],R=this._r[9];n>=16;){var L=e[t+0]|e[t+1]<<8;o+=L&8191;var E=e[t+2]|e[t+3]<<8;a+=(L>>>13|E<<3)&8191;var k=e[t+4]|e[t+5]<<8;i+=(E>>>10|k<<6)&8191;var I=e[t+6]|e[t+7]<<8;l+=(k>>>7|I<<9)&8191;var T=e[t+8]|e[t+9]<<8;s+=(I>>>4|T<<12)&8191,u+=T>>>1&8191;var D=e[t+10]|e[t+11]<<8;c+=(T>>>14|D<<2)&8191;var x=e[t+12]|e[t+13]<<8;d+=(D>>>11|x<<5)&8191;var $=e[t+14]|e[t+15]<<8;m+=(x>>>8|$<<8)&8191,p+=$>>>5|r;var P=0,N=P;N+=o*_,N+=a*(5*R),N+=i*(5*S),N+=l*(5*v),N+=s*(5*b),P=N>>>13,N&=8191,N+=u*(5*C),N+=c*(5*y),N+=d*(5*h),N+=m*(5*g),N+=p*(5*f),P+=N>>>13,N&=8191;var M=P;M+=o*f,M+=a*_,M+=i*(5*R),M+=l*(5*S),M+=s*(5*v),P=M>>>13,M&=8191,M+=u*(5*b),M+=c*(5*C),M+=d*(5*y),M+=m*(5*h),M+=p*(5*g),P+=M>>>13,M&=8191;var w=P;w+=o*g,w+=a*f,w+=i*_,w+=l*(5*R),w+=s*(5*S),P=w>>>13,w&=8191,w+=u*(5*v),w+=c*(5*b),w+=d*(5*C),w+=m*(5*y),w+=p*(5*h),P+=w>>>13,w&=8191;var A=P;A+=o*h,A+=a*g,A+=i*f,A+=l*_,A+=s*(5*R),P=A>>>13,A&=8191,A+=u*(5*S),A+=c*(5*v),A+=d*(5*b),A+=m*(5*C),A+=p*(5*y),P+=A>>>13,A&=8191;var F=P;F+=o*y,F+=a*h,F+=i*g,F+=l*f,F+=s*_,P=F>>>13,F&=8191,F+=u*(5*R),F+=c*(5*S),F+=d*(5*v),F+=m*(5*b),F+=p*(5*C),P+=F>>>13,F&=8191;var O=P;O+=o*C,O+=a*y,O+=i*h,O+=l*g,O+=s*f,P=O>>>13,O&=8191,O+=u*_,O+=c*(5*R),O+=d*(5*S),O+=m*(5*v),O+=p*(5*b),P+=O>>>13,O&=8191;var B=P;B+=o*b,B+=a*C,B+=i*y,B+=l*h,B+=s*g,P=B>>>13,B&=8191,B+=u*f,B+=c*_,B+=d*(5*R),B+=m*(5*S),B+=p*(5*v),P+=B>>>13,B&=8191;var W=P;W+=o*v,W+=a*b,W+=i*C,W+=l*y,W+=s*h,P=W>>>13,W&=8191,W+=u*g,W+=c*f,W+=d*_,W+=m*(5*R),W+=p*(5*S),P+=W>>>13,W&=8191;var q=P;q+=o*S,q+=a*v,q+=i*b,q+=l*C,q+=s*y,P=q>>>13,q&=8191,q+=u*h,q+=c*g,q+=d*f,q+=m*_,q+=p*(5*R),P+=q>>>13,q&=8191;var U=P;U+=o*R,U+=a*S,U+=i*v,U+=l*b,U+=s*C,P=U>>>13,U&=8191,U+=u*y,U+=c*h,U+=d*g,U+=m*f,U+=p*_,P+=U>>>13,U&=8191,P=(P<<2)+P|0,P=P+N|0,N=P&8191,P=P>>>13,M+=P,o=N,a=M,i=w,l=A,s=F,u=O,c=B,d=W,m=q,p=U,t+=16,n-=16}this._h[0]=o,this._h[1]=a,this._h[2]=i,this._h[3]=l,this._h[4]=s,this._h[5]=u,this._h[6]=c,this._h[7]=d,this._h[8]=m,this._h[9]=p},e.prototype.finish=function(e,t){t===void 0&&(t=0);var n=new Uint16Array(10),r,o,a,i;if(this._leftover){for(i=this._leftover,this._buffer[i++]=1;i<16;i++)this._buffer[i]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(r=this._h[1]>>>13,this._h[1]&=8191,i=2;i<10;i++)this._h[i]+=r,r=this._h[i]>>>13,this._h[i]&=8191;for(this._h[0]+=r*5,r=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=r,r=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=r,n[0]=this._h[0]+5,r=n[0]>>>13,n[0]&=8191,i=1;i<10;i++)n[i]=this._h[i]+r,r=n[i]>>>13,n[i]&=8191;for(n[9]-=8192,o=(r^1)-1,i=0;i<10;i++)n[i]&=o;for(o=~o,i=0;i<10;i++)this._h[i]=this._h[i]&o|n[i];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,a=this._h[0]+this._pad[0],this._h[0]=a&65535,i=1;i<8;i++)a=(this._h[i]+this._pad[i]|0)+(a>>>16)|0,this._h[i]=a&65535;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(e){var t=0,n=e.length,r;if(this._leftover){r=16-this._leftover,r>n&&(r=n);for(var o=0;o<r;o++)this._buffer[this._leftover+o]=e[t+o];if(n-=r,t+=r,this._leftover+=r,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(r=n-n%16,this._blocks(e,t,r),t+=r,n-=r),n){for(var o=0;o<n;o++)this._buffer[this._leftover+o]=e[t+o];this._leftover+=n}return this},e.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},e.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e})();u.Poly1305=n;function r(e,t){var r=new n(e);r.update(t);var o=r.digest();return r.clean(),o}u.oneTimeAuth=r;function o(t,n){return t.length!==u.DIGEST_LENGTH||n.length!==u.DIGEST_LENGTH?!1:e.equal(t,n)}u.equal=o}var m=!1;function p(){return m||(m=!0,d()),c.exports}function _(e){switch(e){case void 0:return p()}}a.exports=_}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("stablelib-chacha20poly1305-1.0.1",["stablelib-chacha-1.0.1","stablelib-poly1305-1.0.1","stablelib-wipe-1.0.1","stablelib-binary-1.0.1","stablelib-constant-time-1.0.1"],(function(t,n,r,o,a,i){"use strict";function e(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var l=e(n("stablelib-chacha-1.0.1")),s=e(n("stablelib-poly1305-1.0.1")),u=e(n("stablelib-wipe-1.0.1")),c=e(n("stablelib-binary-1.0.1")),d=e(n("stablelib-constant-time-1.0.1")),m={},p={exports:m};function _(){Object.defineProperty(m,"__esModule",{value:!0});var e=l(),t=s(),n=u(),r=c(),o=d();m.KEY_LENGTH=32,m.NONCE_LENGTH=12,m.TAG_LENGTH=16;var a=new Uint8Array(16),i=(function(){function i(e){if(this.nonceLength=m.NONCE_LENGTH,this.tagLength=m.TAG_LENGTH,e.length!==m.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return i.prototype.seal=function(t,r,o,a){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var i=new Uint8Array(16);i.set(t,i.length-t.length);var l=new Uint8Array(32);e.stream(this._key,i,l,4);var s=r.length+this.tagLength,u;if(a){if(a.length!==s)throw new Error("ChaCha20Poly1305: incorrect destination length");u=a}else u=new Uint8Array(s);return e.streamXOR(this._key,i,r,u,4),this._authenticate(u.subarray(u.length-this.tagLength,u.length),l,u.subarray(0,u.length-this.tagLength),o),n.wipe(i),u},i.prototype.open=function(t,r,a,i){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var l=new Uint8Array(16);l.set(t,l.length-t.length);var s=new Uint8Array(32);e.stream(this._key,l,s,4);var u=new Uint8Array(this.tagLength);if(this._authenticate(u,s,r.subarray(0,r.length-this.tagLength),a),!o.equal(u,r.subarray(r.length-this.tagLength,r.length)))return null;var c=r.length-this.tagLength,d;if(i){if(i.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");d=i}else d=new Uint8Array(c);return e.streamXOR(this._key,l,r.subarray(0,r.length-this.tagLength),d,4),n.wipe(l),d},i.prototype.clean=function(){return n.wipe(this._key),this},i.prototype._authenticate=function(e,o,i,l){var s=new t.Poly1305(o);l&&(s.update(l),l.length%16>0&&s.update(a.subarray(l.length%16))),s.update(i),i.length%16>0&&s.update(a.subarray(i.length%16));var u=new Uint8Array(8);l&&r.writeUint64LE(l.length,u),s.update(u),r.writeUint64LE(i.length,u),s.update(u);for(var c=s.digest(),d=0;d<c.length;d++)e[d]=c[d];s.clean(),n.wipe(c),n.wipe(u)},i})();m.ChaCha20Poly1305=i}var f=!1;function g(){return f||(f=!0,_()),p.exports}function h(e){switch(e){case void 0:return g()}}a.exports=h}),null);
__d("AeadChaPoly",["Hpke","stablelib-chacha20poly1305-1.0.1"],(function(t,n,r,o,a,i,l){"use strict";var e=r("stablelib-chacha20poly1305-1.0.1")(),s=(function(){function t(){this.aead_id=o("Hpke").AeadID.AeadChaCha20Poly1305Id,this.nK=32,this.nN=12,this.nT=16}var n=t.prototype;return n.seal=function(n,r,o,a){var t=new e.ChaCha20Poly1305(n),i=t.seal(r,a,o);return i},n.open=function(n,r,o,a){var t=new e.ChaCha20Poly1305(n),i=t.open(r,a,o);return i},t})();l.AeadChaPoly=s}),98);
__d("VideoPlayerAudioAvailabilityInfo",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.audioAvailability,n=e.mutedSegmentsUnsanitized,r=n.map(function(e){return e.muteStartTimeInSec!=null&&e.muteEndTimeInSec!=null&&e.muteEndTimeInSec>e.muteStartTimeInSec?{muteEndTimeInSec:e.muteEndTimeInSec,muteStartTimeInSec:e.muteStartTimeInSec}:null}).filter(Boolean);return{audioAvailability:t,mutedSegments:r}}function s(e,t){var n=e.audioAvailability,o=e.mutedSegments,a=t.playheadPosition,i,l=!1,s=!1;switch(n){case"AVAILABLE_BUT_MUTED":o.length>0?(l=a!=null&&o.some(function(e){return e.muteStartTimeInSec<=a&&a<=e.muteEndTimeInSec}),l?(i="VOLUME_COPYRIGHT_PARTIAL_SILENCED",s=!0):i="VOLUME_COPYRIGHT_PARTIAL_NOT_SILENCED"):(i="VOLUME_COPYRIGHT_FULL",s=!0);break;case"AVAILABLE_BUT_SILENT":case"UNAVAILABLE":i="VOLUME_SILENT",s=!0;break;case"AVAILABLE":case"UNKNOWN":case"AVAILABLE_BUT_MISSING_LOUDNESS_DATA":case null:case void 0:i="VOLUME_DEFAULT";break;default:r("FBLogger")("comet_video_player").mustfix("Unhandled audio availability: %s",n),i="VOLUME_DEFAULT";break}return{isPlayheadWithinMutedSegment:l,isSilentAtPlayhead:s,volumeControlState:i}}var u=e({audioAvailability:null,mutedSegmentsUnsanitized:[]});l.makeVideoPlayerAudioAvailabilityInfo=e,l.makeVideoPlayerAudioAvailabilityAtPlayheadInfo=s,l.VideoPlayerAudioAvailabilityInfoDefault=u}),98);
__d("normalizeVideoPlayerLoopCount",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){t===void 0&&(t=null),n===void 0&&(n=null);var o=0;if(e==null){var a=t!=null&&t&&n!=null?n:0;a===-1?o=-1:a<0||!Number.isFinite(a)||Math.floor(a)!==a?o=0:a===0&&t===!0?o=-1:o=a}else if(e===-1||e===Number.POSITIVE_INFINITY)o=-1;else{if(e<0||!Number.isFinite(e)||Math.floor(e)!==e)throw r("FBLogger")("comet_video_player").mustfixThrow("Invalid loopingCount: %s",e);o=e}return o}l.default=e}),98);
__d("CoreVideoPlayerMetaData",["VideoPlayerAudioAvailabilityInfo","normalizeVideoPlayerLoopCount"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return e!=null&&isFinite(e)&&e>0?e:0}var s=[];function u(t){var n,a,i,l,u=t.sideLoadCaptionsExpected===!0||t.sideLoadCaptionsUrl!=null,c=t.isLiveStreaming===!0;return babelHelpers.extends({},t,{audioAvailabilityInfo:(n=t.audioAvailabilityInfo)!=null?n:o("VideoPlayerAudioAvailabilityInfo").VideoPlayerAudioAvailabilityInfoDefault,autoplayGatingResult:t.autoplayGatingResult!=null?t.autoplayGatingResult:"unknown",canAutoplay:t.canAutoplay!=null?t.canAutoplay:"allow",desiredLatencyMs:(a=t.desiredLatencyMs)!=null?a:0,inbandCaptionsExpected:c,initialRepresentationIds:(i=t.initialRepresentationIds)!=null?i:s,isNCSR:!!t.isNCSR,isPremiumMusicVideo:!!t.isPremiumMusicVideo,latencyToleranceMs:(l=t.latencyToleranceMs)!=null?l:0,loopCount:r("normalizeVideoPlayerLoopCount")(t.loopCount),sideLoadCaptionsExpected:u,startTimestamp:e(t.startTimestamp)})}l.applyDefaultsToCoreVideoPlayerMetaData=u}),98);
__d("QuicIntCodec",["FBLogger"],(function(t,n,r,o,a,i,l){"use strict";var e=63,s=255,u=64,c=128,d=192,m=64,p=16384,_=1073741824,f=2147483647;function g(e){if(e<m)return 1;if(e<p)return 2;if(e<_)return 4;if(e>f)throw r("FBLogger")("quic_codec").mustfixThrow("Number too large to encode");return 8}function h(t,n){var o=t[n],a=o>>6,i=1<<a;if(o&=e,i===8&&(o>0||t[n+1]>0||t[n+2]>0||t[n+3]>0))throw r("FBLogger")("quic_codec").mustfixThrow("Number is too large to decode");for(var l=1;l<i;l++)o=o<<8|t[n+l];return[o,n+i]}function y(t,n,r){for(var o=t,a=g(o),i=a-1;i>0;i--)n[r+i]=o&s,o>>=8;var l=a===8?d:a===4?c:a===2?u:0;return n[r]=l|o&e,r+a}function C(e){var t=h(e,0),n=t[0],r=t[1];return n}function b(e){var t=g(e),n=new Uint8Array(t);return y(e,n,0),n}l.getByteLength=g,l.decodeQuicIntWithExistingBuffer=h,l.encodeWithExistingBuffer=y,l.decode=C,l.encode=b}),98);
__d("HttpRequestBinaryEncode",["QuicIntCodec","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=new URL(e.url);return{host:t.host,path:t.pathname+t.search,scheme:t.protocol.replace(":","")}}function s(t,n){var r,a=0,i=[],l=n.encode(t.method),s=l.byteLength;a+=(r=o("QuicIntCodec")).getByteLength(s)+s,i.push(l);var u=e(t),c=u.host,d=u.path,m=u.scheme,p=n.encode(m),_=p.byteLength;a+=r.getByteLength(_)+_,i.push(p);var f=n.encode(c),g=f.byteLength;a+=r.getByteLength(g)+g,i.push(f);var h=n.encode(d),y=h.byteLength;return a+=r.getByteLength(y)+y,i.push(h),{length:a,steps:i}}function u(e,t,n){var r=0,a=[],i=new Map(e.headers);n&&!i.has("Host")&&i.set("Host",new URL(e.url).host);for(var l of i){var s=l[0],u=l[1],c=t.encode(s),d=c.byteLength;r+=o("QuicIntCodec").getByteLength(d)+d,a.push(c);var m=t.encode(u),p=m.byteLength;r+=o("QuicIntCodec").getByteLength(m.byteLength)+p,a.push(m)}return{length:r,steps:[r].concat(a)}}function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=new TextEncoder,r=0,a=[];a.push(0),r++;var i=s(e,n),l=i.length,c=i.steps;r+=l,a.push.apply(a,c);var d=u(e,n,t),m=d.length,p=d.steps;r+=o("QuicIntCodec").getByteLength(m)+m,a.push.apply(a,p);var _=new Uint8Array(yield e.arrayBuffer()),f=_.byteLength;return r+=o("QuicIntCodec").getByteLength(f)+f,a.push(_),a.push(0),r++,{length:r,steps:a}}),d.apply(this,arguments)}function m(e,t){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t===void 0&&(t=!1);var n=yield c(e,t),r=n.length,a=n.steps,i=new Uint8Array(r),l=0;for(var s of a)typeof s=="number"?l=o("QuicIntCodec").encodeWithExistingBuffer(s,i,l):(l=o("QuicIntCodec").encodeWithExistingBuffer(s.length,i,l),i.set(s,l),l+=s.length);return i}),p.apply(this,arguments)}l.binaryEncodeRequest=m}),98);
__d("HttpResponseBinaryDecode",["FBLogger","QuicIntCodec"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){var a=n,i=new Headers,l=o("QuicIntCodec").decodeQuicIntWithExistingBuffer(e,a),s=l[0],u=l[1],c=u+s;for(a=u;a<c;){var d=o("QuicIntCodec").decodeQuicIntWithExistingBuffer(e,a),m=d[0],p=d[1],_=t.decode(e.slice(p,p+m));a=p+m;var f=o("QuicIntCodec").decodeQuicIntWithExistingBuffer(e,a),g=f[0],h=f[1],y=t.decode(e.slice(h,h+g));a=h+g,i.append(_,y)}if(c!==a)throw r("FBLogger")("http_binary").mustfixThrow("Decode response with header length mismatch");return{headers:i,offset:a}}function s(t){var n=t[0];if(n!==1)throw r("FBLogger")("http_binary").mustfixThrow("Framing indicator must be 1, but got %s instead",n);var a=1,i=new TextDecoder,l=o("QuicIntCodec").decodeQuicIntWithExistingBuffer(t,a),s=l[0],u=l[1];a=u;var c=a>=t.byteLength?{offset:a,headers:new Headers}:e(t,i,a);a=c.offset;var d=a>=t.byteLength?[0,a]:o("QuicIntCodec").decodeQuicIntWithExistingBuffer(t,a),m=d[0],p=d[1];a=p;var _=m<1?void 0:t.slice(a,a+m);return new Response(_,{headers:c.headers,status:s})}l.binaryDecodeResponse=s}),98);
__d("HttpXHRRequestBinaryEncode",["QuicIntCodec","fbjs/lib/invariant"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=new URL(e.getURI().toString());return{host:t.host,path:t.pathname+t.search,scheme:t.protocol.replace(":","")}}function s(t,n){var r,a=0,i=[],l=n.encode(t.getMethod()),s=l.byteLength;a+=(r=o("QuicIntCodec")).getByteLength(s)+s,i.push(l);var u=e(t),c=u.host,d=u.path,m=u.scheme,p=n.encode(m),_=p.byteLength;a+=r.getByteLength(_)+_,i.push(p);var f=n.encode(c),g=f.byteLength;a+=r.getByteLength(g)+g,i.push(f);var h=n.encode(d),y=h.byteLength;return a+=r.getByteLength(y)+y,i.push(h),{length:a,steps:i}}function u(e,t,n){var a=0,i=[],l=e.getAllRequestHeaders();l!=null||r("fbjs/lib/invariant")(0,87335);var s=new Map(Object.entries(l));n&&!s.has("Host")&&s.set("Host",new URL(e.getURI().toString()).host);for(var u of s){var c=u[0],d=u[1],m=t.encode(c),p=m.byteLength;a+=o("QuicIntCodec").getByteLength(p)+p,i.push(m);var _=t.encode(d),f=_.byteLength;a+=o("QuicIntCodec").getByteLength(_.byteLength)+f,i.push(_)}return{length:a,steps:[a].concat(i)}}function c(e,t){var n=new TextEncoder,a=0,i=[];i.push(0),a++;var l=s(e,n),c=l.length,d=l.steps;a+=c,i.push.apply(i,d);var m=u(e,n,t),p=m.length,_=m.steps;a+=o("QuicIntCodec").getByteLength(p)+p,i.push.apply(i,_);var f=e.getData();f!=null||r("fbjs/lib/invariant")(0,21489);var g=n.encode(f),h=g.byteLength;return a+=o("QuicIntCodec").getByteLength(h)+h,i.push(g),i.push(0),a++,{length:a,steps:i}}function d(e,t){t===void 0&&(t=!1);var n=c(e,t),r=n.length,a=n.steps,i=new Uint8Array(r),l=0;for(var s of a)typeof s=="number"?l=o("QuicIntCodec").encodeWithExistingBuffer(s,i,l):(l=o("QuicIntCodec").encodeWithExistingBuffer(s.length,i,l),i.set(s,l),l+=s.length);return i}l.binaryEncodeRelayAPIRequest=d}),98);
__d("KdfHkdfSha256",["Hpke","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e=window.crypto||window.msCrypto,s=new TextEncoder,u=s.encode("HPKE-v1"),c=(function(){function t(t){t===void 0&&(t=e.subtle),this.kdf_id=o("Hpke").KdfID.KdfHkdfSha256Id,this.nH=32,this.internalCryptoProvider=null,this.internalCryptoProvider=t}var r=t.prototype;return r.hmac=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.internalCryptoProvider.importKey("raw",e.byteLength===0?new Uint8Array(32):e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),r=yield this.internalCryptoProvider.sign("HMAC",n,t);return new Uint8Array(r)});function t(t,n){return e.apply(this,arguments)}return t})(),r.extract=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield this.hmac(e,t);return n});function t(t,n){return e.apply(this,arguments)}return t})(),r.expand=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=new Uint8Array(n),o=new Uint8Array(0),a=new Uint8Array(t),i=new Uint8Array(1);if(n>8160){var l=new Error("KDF expand: entropy limit reached");throw l.stack,l}for(var s=new Uint8Array(32+a.length+1),u=1,c=0;c<r.length;u++)i[0]=u,s.set(o,0),s.set(a,o.length),s.set(i,o.length+a.length),o=yield this.hmac(e,s.slice(0,o.length+a.length+1)),r.length-c>=o.length?(r.set(o,c),c+=o.length):(r.set(o.slice(0,r.length-c),c),c+=r.length-c);return r});function t(t,n,r){return e.apply(this,arguments)}return t})(),r.labeledExtract=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r){var a=o("Hpke").concat(u,r,t,n),i=yield this.extract(e,a);return i});function t(t,n,r,o){return e.apply(this,arguments)}return t})(),r.labeledExpand=(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n,r,a){var i=o("Hpke").concat(new Uint8Array([0,r]),u,a,t,n);return yield this.expand(e,i,r)});function t(t,n,r,o,a){return e.apply(this,arguments)}return t})(),t})();l.KdfHkdfSha256=c}),98);
__d("x25519FromNacl",[],(function(t,n,r,o,a,i){"use strict";var e=function(t){var e,n=new Float64Array(16);if(t)for(e=0;e<t.length;e++)n[e]=t[e];return n},l=new Uint8Array(32);l[0]=9;var s=e(),u=e([1]),c=e([56129,1]),d=e([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),m=e([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),p=e([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),_=e([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),f=e([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function g(e,t){var n;for(n=0;n<16;n++)e[n]=t[n]|0}function h(e){var t,n;for(n=0;n<16;n++)e[n]+=65536,t=Math.floor(e[n]/65536),e[(n+1)*(n<15?1:0)]+=t-1+37*(t-1)*(n===15?1:0),e[n]-=t*65536}function y(e,t,n){for(var r,o=~(n-1),a=0;a<16;a++)r=o&(e[a]^t[a]),e[a]^=r,t[a]^=r}function C(t,n){var r,o,a,i=e(),l=e();for(r=0;r<16;r++)l[r]=n[r];for(h(l),h(l),h(l),o=0;o<2;o++){for(i[0]=l[0]-65517,r=1;r<15;r++)i[r]=l[r]-65535-(i[r-1]>>16&1),i[r-1]&=65535;i[15]=l[15]-32767-(i[14]>>16&1),a=i[15]>>16&1,i[14]&=65535,y(l,i,1-a)}for(r=0;r<16;r++)t[2*r]=l[r]&255,t[2*r+1]=l[r]>>8}function b(e,t){var n;for(n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}function v(e,t,n){var r;for(r=0;r<16;r++)e[r]=t[r]+n[r]|0}function S(e,t,n){var r;for(r=0;r<16;r++)e[r]=t[r]-n[r]|0}function R(e,t,n){var r,o,a=new Float64Array(31);for(r=0;r<31;r++)a[r]=0;for(r=0;r<16;r++)for(o=0;o<16;o++)a[r+o]+=t[r]*n[o];for(r=0;r<15;r++)a[r]+=38*a[r+16];for(r=0;r<16;r++)e[r]=a[r];h(e),h(e)}function L(e,t){R(e,t,t)}function E(t,n){var r=e(),o;for(o=0;o<16;o++)r[o]=n[o];for(o=253;o>=0;o--)L(r,r),o!==2&&o!==4&&R(r,r,n);for(o=0;o<16;o++)t[o]=r[o]}function k(t,n,r){var o=new Uint8Array(32),a=new Float64Array(80),i,l,s=e(),u=e(),d=e(),m=e(),p=e(),_=e();for(l=0;l<31;l++)o[l]=n[l];for(o[31]=n[31]&127|64,o[0]&=248,b(a,r),l=0;l<16;l++)u[l]=a[l],m[l]=s[l]=d[l]=0;for(s[0]=m[0]=1,l=254;l>=0;--l)i=o[l>>>3]>>>(l&7)&1,y(s,u,i),y(d,m,i),v(p,s,d),S(s,s,d),v(d,u,m),S(u,u,m),L(m,p),L(_,s),R(s,d,s),R(d,u,p),v(p,s,d),S(s,s,d),L(u,s),S(d,m,_),R(s,d,c),v(s,s,m),R(d,d,s),R(s,m,_),R(m,u,a),L(u,p),y(s,u,i),y(d,m,i);for(l=0;l<16;l++)a[l+16]=s[l],a[l+32]=d[l],a[l+48]=u[l],a[l+64]=m[l];var f=a.subarray(32),g=a.subarray(16);return E(f,f),R(g,g,f),C(t,g),0}function I(e,t){return k(e,t,l)}function T(e,t,n){return n(t,32),I(e,t)}function D(t,n){var r=e(),o=e(),a=e(),i=e(),l=e(),s=e(),u=e(),c=e(),d=e();S(r,t[1],t[0]),S(d,n[1],n[0]),R(r,r,d),v(o,t[0],t[1]),v(d,n[0],n[1]),R(o,o,d),R(a,t[3],n[3]),R(a,a,m),R(i,t[2],n[2]),v(i,i,i),S(l,o,r),S(s,i,a),v(u,i,a),v(c,o,r),R(t[0],l,s),R(t[1],c,u),R(t[2],u,s),R(t[3],l,c)}function x(e,t,n){var r;for(r=0;r<4;r++)y(e[r],t[r],n)}var $=32,P=32,N=32,M=32;function w(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function A(e){for(var t=0;t<e.length;t++)e[t]=0}var F=(function(){function e(){this.randombytesFn=function(){throw new Error("no CSPRNG")};var e=typeof self!="undefined"?self.crypto||self.msCrypto:null;if(e&&e.getRandomValues){var t=65536;this.randombytesFn=function(n,r){var o,a=new Uint8Array(r);for(o=0;o<r;o+=t)e.getRandomValues(a.subarray(o,o+Math.min(r-o,t)));for(o=0;o<r;o++)n[o]=a[o];A(a)}}else e&&e.randomBytes&&(this.randombytesFn=function(t,n){var r,o=e.randomBytes(n);for(r=0;r<n;r++)t[r]=o[r];A(o)})}var t=e.prototype;return t.scalarMult=function(t,n){if(w(t,n),t.length!==P)throw new Error("bad n size");if(n.length!==$)throw new Error("bad p size");var e=new Uint8Array($);return k(e,t,n),e},t.scalarMultBase=function(t){if(w(t),t.length!==P)throw new Error("bad n size");var e=new Uint8Array($);return I(e,t),e},t.boxKeyPair=function(){var e=new Uint8Array(N),t=new Uint8Array(M);return T(e,t,this.randombytesFn),{publicKey:e,secretKey:t}},t.boxKeyPairFromSecretKey=function(t){if(w(t),t.length!==M)throw new Error("bad secret key size");var e=new Uint8Array(N);return I(e,t),{publicKey:e,secretKey:new Uint8Array(t)}},t.setPRNG=function(t){this.randombytesFn=t},e})();i.default=F}),66);
__d("KemX25519HkdfSha256",["Hpke","KdfHkdfSha256","asyncToGeneratorRuntime","x25519FromNacl"],(function(t,n,r,o,a,i,l){"use strict";var e=new(r("x25519FromNacl")),s=new TextEncoder,u=s.encode("eae_prk"),c=s.encode("shared_secret"),d=s.encode("KEM"),m=(function(){function t(e){e===void 0&&(e=new(o("KdfHkdfSha256")).KdfHkdfSha256),this.kem_id=o("Hpke").KemID.KemX25519HkdfSha256Id,this.nSecret=32,this.nEnc=32,this.kdf=e}var r=t.prototype;return r.createKeyPair=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield e.boxKeyPair();return{pk:t.publicKey,sk:t.secretKey}});function r(){return t.apply(this,arguments)}return r})(),r.pk=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield e.boxKeyPairFromSecretKey(t);return n.publicKey});function r(e){return t.apply(this,arguments)}return r})(),r.encap=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=yield this.createKeyPair(),r=e.scalarMult(n.sk,t),a=o("Hpke").concat(n.pk,t),i=o("Hpke").concat(d,o("Hpke").i2osp(this.kem_id,2)),l=yield this.kdf.labeledExtract(new Uint8Array(0),u,r,i),s=yield this.kdf.labeledExpand(l,c,a,this.nSecret,i);return{sharedSecret:s,enc:n.pk}});function r(e){return t.apply(this,arguments)}return r})(),r.decap=(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,n){var r=e.scalarMult(n,t),a=e.scalarMultBase(n),i=o("Hpke").concat(t,a),l=o("Hpke").concat(d,o("Hpke").i2osp(this.kem_id,2)),s=yield this.kdf.labeledExtract(new Uint8Array(0),u,r,l),m=yield this.kdf.labeledExpand(s,c,i,this.nSecret,l);return m});function r(e,n){return t.apply(this,arguments)}return r})(),t})();l.KemX25519HkdfSha256=m}),98);
__d("MediaPlaybackTagMetadataHighFrequencyCategory",[],(function(t,n,r,o,a,i){var e=Object.freeze({FB_BANDWIDTH:"fb_bandwidth",VIDEO_BANDWIDTH:"video_bandwidth",TOTAL_FRAME_COUNT:"total_frame_count",DROPPED_FRAME_COUNT:"dropped_frame_count",LARGE_DROPPED_FRAME_COUNT:"large_dropped_frame_count",VERY_LARGE_DROPPED_FRAME_COUNT:"very_large_dropped_frame_count",TASOS_VIDEO_TRANSPORT_BWE_BITS_PER_SEC:"tasos_video_transport_bwe_bits_per_sec",AVG_DECODE_TIME:"avg_decode_time",AVG_RENDER_TIME:"avg_render_time",LIVE_LATENCY_FRAMES:"live_latency_frames",DROPPED_FRAME_BUCKETIZED:"dropped_frame_bucketized"});i.default=e}),66);
__d("hashString",[],(function(t,n,r,o,a,i){"use strict";function e(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);t=(t<<5)-t+r,t|=0}return t}i.default=e}),66);
__d("MediaPlaybackCompoundEventStateMachineLogger",["MediaPlaybackTagMetadataHighFrequencyCategory","NetworkStatus","SiteData","emptyFunction","gkx","hashString","justknobx"],(function(t,n,r,o,a,i,l){"use strict";var e,s=6e4,u=1e3,c=Object.freeze(["paused","completed","cancelled","error","heartbeat"]),d=e=r("emptyFunction"),m=e,p=e,_=e,f=!1;r("gkx")("494")&&(f=!0,d=function(t,n){try{for(var e,r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];(e=window.console).info.apply(e,["["+t+"][SNAPL]"+n].concat(o))}catch(e){}},m=function(t,n,r,o){d(t,"[handleMetaData]",{loggingMetaData:r,loggingMetaDataPrevious:n,trackedChanges:o})},p=function(t,n,r,o){d(t,"[handleStateMachine]",{prevState:n,state:r,action:o})},_=function(t,n){d(t,"[setAdditionalLogData(SNAPL)]",{values:n})});function g(){return{bufferingSequenceStartClockTimestamp:null,canLogPausedOrFinishedPlaying:!1,canLogPlayingEvent:!0,errorRecoveryAttemptState:{eventsLogged:0},hasLoggedStartedPlaying:!1,hasPendingRequestedPlaying:!1,isLoggingScrubbingSequence:!1,lastLoggedError:null,lastLoggedTagMetadata:{},nextHeartbeatTime:null,shouldIgnoreDomPause:!1,shouldIgnoreDomPlay:!1,shouldLogRequestedPlayingForScrub:!1,warningState:{eventsLoggedPerKey:new Map,eventsLoggedTotal:0,eventsMaxLoggedPerKey:(function(){try{return Math.max(0,r("justknobx")._("1831")||0)}catch(e){return 0}})(),eventsMaxLoggedTotal:(function(){try{return Math.max(0,r("justknobx")._("1832")||0)}catch(e){return 0}})()}}}function h(e){var t={},n=e.initialLoggingMetaData,o=e.initialCoreVideoPlayerMetaData,a=n,i=[],l=g(),h=[],y={};function C(t){var r,a,s=t.events,u=t.state,c=babelHelpers.extends({},o.loggingToSNAPLAdditionalData,y),m=(r=(a=e.metadataProvider)==null?void 0:a.getRequiredMetadata({coreVideoPlayerMetaData:o,logDataAdditions:c,loggingMetaData:n,state:u}))!=null?r:{current_watching_module:"",media_id:"",tracking_type:"none"},p={events:s,required_metadata:m};i.push(p),f&&d(e.debugLogId,"[_push] "+p.events.map(function(e){return e.event_name}).join(","),{loggedEvent:p,loggerEventsLength:i.length,loggingState:JSON.stringify(l)})}function b(n){var r=n.event,o=n.state;if(h.push(r),f&&d(e.debugLogId,"[_addEvent] "+r.event_name,{event:r,eventsListLength:h.length,loggingState:JSON.stringify(l)}),c.includes(r.event_name)){var a=[].concat(h);h=[],C({events:a,state:o})}return t}function v(){return l.hasLoggedStartedPlaying?"unpaused":"started"}function S(e,t){var o=e.uncontrolledState.videoElementDuration;return{client_time_ms:r("gkx")("18028")?Math.floor(e.uncontrolledState.clockTimestamp).toString():Math.round(e.uncontrolledState.clockTimestamp).toString(),event_name:t,media_time_ms:e.uncontrolledState.videoElementPlayheadPosition!=null?Math.round(e.uncontrolledState.videoElementPlayheadPosition*1e3).toString():"0",player_instance_id:Math.abs(r("hashString")(n.instanceKey)).toString(),player_instance_key:n.instanceKey,video_client_duration:o!=null?Math.trunc(o*1e3).toString():void 0}}function R(t){if(a=n,t.type==="notify_logging_metadata_change"){var r=t.payload,i=r.coreVideoPlayerMetaData,l=r.loggingMetaData;if(f){var s=i.initialTracePolicy!==o.initialTracePolicy;m(e.debugLogId,n,l,{initialTracePolicyChanged:s})}n=l,o=i}}function L(e,n,r){if(e.controlledState.playbackState!==n.controlledState.playbackState&&n.controlledState.playbackState==="ended"&&l.canLogPausedOrFinishedPlaying){k(n);var o=S(n,"completed");return b({event:o,state:n}),l.canLogPausedOrFinishedPlaying=!1,t}else return t}function E(e,n){var r=S(e,"requested_playing"),o=n!=null?babelHelpers.extends({},r,{media_time_ms:Math.round(n*1e3).toString(),start_state:v()}):babelHelpers.extends({},r,{start_state:v()});return b({event:o,state:e}),l.hasPendingRequestedPlaying=!0,l.canLogPausedOrFinishedPlaying=!0,t}function k(r,a){var i,l=babelHelpers.extends({},o.loggingToSNAPLAdditionalData,y),s=(i=e.metadataProvider)==null?void 0:i.getTagMetadata({coreVideoPlayerMetaData:o,logDataAdditions:l,loggingMetaData:n,state:r});if(Object.keys(s!=null?s:{}).length>0){a&&(s=babelHelpers.extends({},s,a));var u=babelHelpers.extends({},S(r,"tags_changed"),{tag_metadata:s});b({event:u,state:r})}return t}function I(e){if(l.canLogPausedOrFinishedPlaying){if(l.hasPendingRequestedPlaying)return k(e),T(e),l.canLogPausedOrFinishedPlaying=!1,l.hasPendingRequestedPlaying=!1,t;k(e);var n=S(e,"paused");return b({event:n,state:e}),l.canLogPausedOrFinishedPlaying=!1,l.hasPendingRequestedPlaying=!1,t}else return t}function T(e){var n=S(e,"cancelled");return b({event:n,state:e}),t}function D(e,n,r){if(r.type==="dom_event_play_promise_rejected"&&l.hasPendingRequestedPlaying){var o=r.payload.playPromiseRejectionReason;return o!=null&&o.name==="NotAllowedError"&&T(n),t}else return t}function x(e,n,r){return(r.type==="controller_play_requested"||r.type==="dom_event_play"&&!l.shouldIgnoreDomPlay)&&e.controlledState.playbackState!==n.controlledState.playbackState&&E(n),t}function $(e){var n=S(e,"requested_seek");return b({event:n,state:e}),t}function P(e,n,r){var o=n.controlledState.playbackState,a=e.controlledState.playbackState;return r.type==="controller_scrub_begin_requested"&&!e.controlledState.scrubbing&&o!=="paused"&&o!=="ended"?(I(n),$(n),l.isLoggingScrubbingSequence=!0,t):!e.controlledState.seeking&&n.controlledState.seeking&&!l.isLoggingScrubbingSequence&&o!=="paused"&&o!=="ended"&&!l.hasPendingRequestedPlaying?(I(n),$(n),l.shouldLogRequestedPlayingForScrub=!0,t):r.type==="controller_scrub_end_requested"&&e.controlledState.scrubbing&&o!=="paused"&&o!=="ended"?(E(n,r.payload.seekTargetPosition),t):(e.controlledState.seeking&&!n.controlledState.seeking&&(l.shouldLogRequestedPlayingForScrub&&o!=="paused"&&o!=="ended"&&E(n),l.isLoggingScrubbingSequence=!1,l.shouldLogRequestedPlayingForScrub=!1,a!=="paused"&&a!=="ended"&&(l.canLogPlayingEvent=!0)),t)}function N(e,n,o){if(e.controlledState.playbackState==="stalling"&&n.controlledState.playbackState==="playing"&&l.canLogPlayingEvent){var a=babelHelpers.extends({},S(n,"started_playing"),{start_state:v()});return b({event:a,state:n}),l.canLogPlayingEvent=!1,l.hasPendingRequestedPlaying=!1,l.hasLoggedStartedPlaying=!0,k(n,{web_client_revision:String(r("SiteData").client_revision)}),t}else return t}function M(e,n,r){return(r.type==="controller_pause_requested"||r.type==="dom_event_pause"&&!l.shouldIgnoreDomPause)&&e.controlledState.playbackState!==n.controlledState.playbackState&&I(n),t}function w(e,n,r){var o=n.controlledState.playbackState;return o!=="paused"&&o!=="ended"&&(r.type==="implementation_video_node_unmounted"?I(e):(r.type==="implementation_unmounted"||r.type==="implementation_engine_destroy_requested")&&I(n)),t}function A(r,a,i){var s=a.controlledState.error;if(s!=null&&s!==l.lastLoggedError&&s.errorCode!=="410"){var u;k(a);var c=babelHelpers.extends({},(u=e.metadataProvider)==null?void 0:u.getErrorMetadata({action:i,coreVideoPlayerMetaData:o,loggingMetaData:n,state:a,videoPlayerError:s}),{name:"failed_playing"}),d=babelHelpers.extends({},S(a,"error"),{error_metadata:c});b({event:d,state:a}),l.lastLoggedError=s}return t}function F(a,i,s){if(s.type==="error_recovery_attempt"&&l.errorRecoveryAttemptState.eventsLogged<u){var c,d=s.payload.recoverableError;if(d!=null&&d.errorName==="OZ_NETWORK"&&!r("NetworkStatus").isOnline())return t;var m=babelHelpers.extends({},(c=e.metadataProvider)==null?void 0:c.getErrorMetadata({action:s,coreVideoPlayerMetaData:o,loggingMetaData:n,state:i,videoPlayerError:d}),{name:"error_recovery_attempt"}),p=babelHelpers.extends({},S(i,"error"),{error_metadata:m});b({event:p,state:i}),l.errorRecoveryAttemptState.eventsLogged++}return t}function O(e,n,r){var o=e.controlledState.playbackState,a=n.controlledState.playbackState;if(l.hasPendingRequestedPlaying||l.shouldLogRequestedPlayingForScrub||l.bufferingSequenceStartClockTimestamp!=null)return t;if(o!=="stalling"&&a==="stalling"){var i=S(n,"started_buffering");b({event:i,state:n}),l.bufferingSequenceStartClockTimestamp=n.uncontrolledState.clockTimestamp,l.shouldIgnoreDomPause=!0,l.shouldIgnoreDomPlay=!0}return t}function B(e,n,o){var a=e.controlledState.playbackState,i=n.controlledState.playbackState,s=l.bufferingSequenceStartClockTimestamp;if(s==null)return t;if((o.type==="dom_event_playing"||o.type==="buffering_end_requested")&&a==="stalling"&&i!=="stalling"){var u=0;o.payload.domEventPerfTimestamp!=null&&(u=Math.max(n.uncontrolledState.perfTimestamp-o.payload.domEventPerfTimestamp,0));var c=Math.round(r("gkx")("18028")?Math.max(s,n.uncontrolledState.clockTimestamp-u):n.uncontrolledState.clockTimestamp-u),d=babelHelpers.extends({},S(n,"stopped_buffering"),{client_time_ms:c.toString()});b({event:d,state:n}),l.bufferingSequenceStartClockTimestamp=null,l.shouldIgnoreDomPause=!1,l.shouldIgnoreDomPlay=!1}return t}function W(e,n,r){var o=n.controlledState.playbackState;o==="paused"||o==="ended"?l.nextHeartbeatTime=null:o!=="stalling"&&l.nextHeartbeatTime==null&&(l.nextHeartbeatTime=n.uncontrolledState.clockTimestamp+s);var a=l.nextHeartbeatTime;if(a!=null){var i=n.uncontrolledState.clockTimestamp;if(i>=a){if(o!=="stalling"){var u=S(n,"heartbeat");b({event:u,state:n})}l.nextHeartbeatTime=i+s}}return t}function q(e){var t=e.errorMessageFormat,n=e.errorName,r=e.errorCode==null||e.errorCode===""?n:e.errorCode,o=n+"#"+r+": "+U(t);return o}function U(e){return e.replace(/([0-9]{2,})/g,function(e){for(var t="";t.length<e.length;)t+="#";return t})}function V(a,i,s){if(r("justknobx")._("3727"))return t;if(s.type==="implementation_warning"){var u,c=s.payload.warningError,d=q(c),m=l.warningState.eventsLoggedTotal,p=(u=l.warningState.eventsLoggedPerKey.get(d))!=null?u:0;if(m<l.warningState.eventsMaxLoggedTotal&&p<l.warningState.eventsMaxLoggedPerKey){var _;l.warningState.eventsLoggedTotal++,l.warningState.eventsLoggedPerKey.set(d,p+1);var f=babelHelpers.extends({},(_=e.metadataProvider)==null?void 0:_.getErrorMetadata({action:s,coreVideoPlayerMetaData:o,loggingMetaData:n,state:i,videoPlayerError:c}),{name:"player_warning"}),g=babelHelpers.extends({},S(i,"error"),{error_metadata:f});b({event:g,state:i})}}return t}function H(a,i,s){var u,c=babelHelpers.extends({},o.loggingToSNAPLAdditionalData,y),d=l.lastLoggedTagMetadata,m=(u=e.metadataProvider)==null?void 0:u.getTagMetadata({coreVideoPlayerMetaData:o,logDataAdditions:c,loggingMetaData:n,state:i});if(m&&JSON.stringify(m)!==JSON.stringify(d)){var p={};Object.keys(m).forEach(function(e){if(m[e]!==d[e]){var t;p=babelHelpers.extends({},p,(t={},t[e]=m[e],t))}});var _=Object.values(r("MediaPlaybackTagMetadataHighFrequencyCategory")),f=Object.keys(p).every(function(e){return _.includes(e)});if(f)return t;var g=babelHelpers.extends({},S(i,"tags_changed"),{tag_metadata:p});b({event:g,state:i}),l.lastLoggedTagMetadata=babelHelpers.extends({},d,m)}return t}return{consumeLoggerEvents:function(){return i.length>0?i.splice(0):[]},handleStateMachine:function(n,r,o){R(o);var t=r.controlledState.playbackState,a=[H,D,x,P,O,B,N,L,M,w,A,F,V,W];a.forEach(function(e){e(n,r,o)}),f&&p(e.debugLogId,n,r,o),(t==="paused"||t==="ended")&&(l.canLogPlayingEvent=!0),o.type==="controller_pause_requested"&&(l.shouldIgnoreDomPause=!0),o.type==="controller_play_requested"&&(l.shouldIgnoreDomPlay=!0),o.type==="dom_event_pause"&&(l.shouldIgnoreDomPause=!1),o.type==="dom_event_play"&&(l.shouldIgnoreDomPlay=!1)},logPausedOnBeforeUnload:function(t){I(t)},setLoggingToSNAPLAdditionalData:function(n){Object.assign(y,n),f&&_(e.debugLogId,n)}}}l.HEARTBEAT_INTERVAL=s,l.createMediaPlaybackCompoundEventStateMachineLogger=h}),98);
__d("OhaiCommonUtils",[],(function(t,n,r,o,a,i){"use strict";var e="message/bhttp request",l="message/bhttp response";function s(e){var t=window.crypto||window.msCrypto,n=new Uint8Array(e);return t.getRandomValues(n),n}function u(e,t){for(var n=new Uint8Array(t),r=e,o=t-1;o>=0;o--)n[o]=r&255,r>>=8;return n}function c(e,t){for(var n=0,r=0;r<t;r++)n<<=8,n|=e[r];return n}function d(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce(function(e,t){return e+t.length},0),o=new Uint8Array(r),a=0;for(var i of t)o.set(i,a),a+=i.length;return o}var m=new TextEncoder().encode("");i.REQUEST_LABEL=e,i.RESPONSE_LABEL=l,i.randomBytes=s,i.encodeNumber=u,i.decodeNumber=c,i.concat=d,i.EMPTY_AAD=m}),66);
__d("getHpkeFromConfigIds",["AeadAes128Gcm","AeadChaPoly","Hpke","KdfHkdfSha256","KemX25519HkdfSha256"],(function(t,n,r,o,a,i,l){"use strict";function e(e){switch(e){case o("Hpke").KemID.KemX25519HkdfSha256Id:return new(o("KemX25519HkdfSha256")).KemX25519HkdfSha256}}function s(e){switch(e){case o("Hpke").KdfID.KdfHkdfSha256Id:return new(o("KdfHkdfSha256")).KdfHkdfSha256}}function u(e){switch(e){case o("Hpke").AeadID.AeadAes128GcmId:return new(o("AeadAes128Gcm")).AeadAes128Gcm;case o("Hpke").AeadID.AeadChaCha20Poly1305Id:return new(o("AeadChaPoly")).AeadChaPoly}}function c(t){var n=t.kemId,r=t.kdfId,a=t.aeadId;return new(o("Hpke")).Hpke(e(n),s(r),u(a))}l.default=c}),98);
__d("OhaiClient",["HttpRequestBinaryEncode","HttpResponseBinaryDecode","HttpXHRRequestBinaryEncode","OhaiCommonUtils","asyncToGeneratorRuntime","getHpkeFromConfigIds"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){n===void 0&&(n=!1);var a=e.keyId,i=e.kemId,l=e.kdfId,s=e.aeadId,u=e.publicKey,c=r("getHpkeFromConfigIds")({kemId:i,kdfId:l,aeadId:s}),d=new TextEncoder,m=yield o("HttpRequestBinaryEncode").binaryEncodeRequest(t,n),p=o("OhaiCommonUtils").concat(o("OhaiCommonUtils").encodeNumber(a,1),o("OhaiCommonUtils").encodeNumber(i,2),o("OhaiCommonUtils").encodeNumber(l,2),o("OhaiCommonUtils").encodeNumber(s,2)),_=d.encode(o("OhaiCommonUtils").REQUEST_LABEL),f=yield c.setupBaseS(u,_),g=f.enc,h=f.ctx,y=yield h.seal(p,m),C=o("OhaiCommonUtils").concat(p,g,y);return{ctx:h,enc:g,encapsulatedRequest:C}}),s.apply(this,arguments)}function u(e,t,n){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){n===void 0&&(n=!1);var a=e.keyId,i=e.kemId,l=e.kdfId,s=e.aeadId,u=e.publicKey,c=r("getHpkeFromConfigIds")({kemId:i,kdfId:l,aeadId:s}),d=new TextEncoder,m=yield o("HttpXHRRequestBinaryEncode").binaryEncodeRelayAPIRequest(t,n),p=o("OhaiCommonUtils").concat(o("OhaiCommonUtils").encodeNumber(a,1),o("OhaiCommonUtils").encodeNumber(i,2),o("OhaiCommonUtils").encodeNumber(l,2),o("OhaiCommonUtils").encodeNumber(s,2)),_=d.encode(o("OhaiCommonUtils").REQUEST_LABEL),f=yield c.setupBaseS(u,_),g=f.enc,h=f.ctx,y=yield h.seal(p,m),C=o("OhaiCommonUtils").concat(p,g,y);return{ctx:h,enc:g,encapsulatedRequest:C}}),c.apply(this,arguments)}function d(e,t,n){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t,n){var r=e.aead,a=e.kdf,i=r.nN,l=r.nK,s=Math.max(i,l),u=n.slice(0,s),c=n.slice(s),d=new TextEncoder,m=yield e.export(d.encode(o("OhaiCommonUtils").RESPONSE_LABEL),l),p=o("OhaiCommonUtils").concat(t,u),_=yield a.extract(p,m),f=yield a.expand(_,d.encode("key"),l),g=yield a.expand(_,d.encode("nonce"),i),h=yield r.open(f,g,o("OhaiCommonUtils").EMPTY_AAD,c),y=yield o("HttpResponseBinaryDecode").binaryDecodeResponse(h);return y}),m.apply(this,arguments)}l.encapsulateRequest=e,l.encapsulateRelayAPIRequest=u,l.decapsulateResponse=d}),98);
__d("VideoPlaybackQuality",[],(function(t,n,r,o,a,i){function e(e){if(typeof e.getVideoPlaybackQuality=="function")return e.getVideoPlaybackQuality().droppedVideoFrames;var t=e.webkitDroppedFrameCount;return typeof t=="number"?t:0}function l(e){if(typeof e.getVideoPlaybackQuality=="function")return e.getVideoPlaybackQuality().totalVideoFrames;var t=e.webkitDecodedFrameCount;return typeof t=="number"?t:0}i.getDroppedFrames=e,i.getTotalFrames=l}),66);
__d("VideoPlayerContextSensitiveConfigUtils",[],(function(t,n,r,o,a,i){"use strict";var e=function(t,n){return n.every(function(e){return t[e.name]===e.value})},l=function(n,r){return r.find(function(t){return e(n,t.contexts)})};i.getFirstMatchingValueAndContextTargets=l}),66);
__d("VideoPlayerContextSensitiveConfigResolver",["VideoPlayerContextSensitiveConfigPayload","VideoPlayerContextSensitiveConfigUtils","cr:1724253"],(function(t,n,r,o,a,i,l){"use strict";var e=(function(){function e(e){this.$1={},this.$2={},e==null?(this.$3=r("VideoPlayerContextSensitiveConfigPayload").static_values,this.$4=r("VideoPlayerContextSensitiveConfigPayload").context_sensitive_values):(this.$3=e.staticValues,this.$4=e.contextSensitiveValues)}var t=e.prototype;return t.setContexts=function(t){this.$1=t,this.$2=this.$5(t)},t.getValue=function(t){return this.$2[t]!=null?this.$2[t]:this.$3[t]!=null?this.$3[t]:null},t.$5=function(t){var e=this;return Object.keys(this.$4).reduce(function(n,r){var a=e.$4[r];if(a!=null){var i=o("VideoPlayerContextSensitiveConfigUtils").getFirstMatchingValueAndContextTargets(t,a);i!=null&&(n[r]=i.value)}return n},{})},e.getPayload=function(){return r("VideoPlayerContextSensitiveConfigPayload")},e.getSources=function(){return n("cr:1724253")},e})();l.default=e}),98);
__d("isPrimitive",[],(function(t,n,r,o,a,i){"use strict";function e(e){switch(Object.prototype.toString.call(e)){case"[object String]":case"[object Number]":case"[object Boolean]":case"[object Null]":case"[object Undefined]":return!0}return!1}i.default=e}),66);
__d("deepEquals",["isPrimitive"],(function(t,n,r,o,a,i,l){"use strict";var e=function(t){return(function(e,n){return d(e,t[n])})},s=function(t,n){return(function(e){return e in t&&e in n&&d(t[e],n[e])})},u=function(t,n){if(t.size!==n.size)return!1;var e=new Set(n);for(var o of t.keys())if(e.has(o))e.delete(o);else{if(r("isPrimitive")(o))return!1;var a=c(e,o);if(a!=null)e.delete(a);else return!1}return e.size===0};function c(e,t){for(var n of e)if(d(n,t))return n;return null}function d(t,n){if(t===n)return!0;if(r("isPrimitive")(t)||Object.prototype.toString.call(t)!==Object.prototype.toString.call(n))return!1;if(Array.isArray(t))return t.length===n.length&&t.every(e(n));if(t instanceof Set)return u(t,n);var o=Object.keys(t);return o.length!==Object.keys(n).length?!1:o.every(s(t,n))}l.default=d}),98);
__d("VideoPlayerEmsgForStateMachine",["deepEquals"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n,r,o;return[e.type,e.emsgScheme,(n=e.emsgId)!=null?n:""].concat(t?[(r=e.emsgStartTimeInSec)!=null?r:"",(o=e.emsgDurationInSec)!=null?o:""]:[]).join(":")}function s(t,n){return t.set(e(n,!0),n),t}function u(e,t){return t.reduce(s,new Map(e))}function c(t,n,o){var a=n==null?[]:Array.from(t.values()).filter(function(e){var t=e.emsgStartTimeInSec,r=e.emsgDurationInSec||0;return t!=null&&n>=t&&n<t+r}).sort(function(e,t){return(e.emsgStartTimeInSec||0)-(t.emsgStartTimeInSec||0)}),i=Array.from(a.reduce(function(t,n){return t.set(e(n,!1),n),t},new Map).values());return r("deepEquals")(o,i)?o:i}l.makeEmsgBoxDedupKey=e,l.makeUpdatedAllEmsgBoxes=u,l.makeUpdatedActiveEmsgBoxes=c}),98);
__d("VideoPlayerShakaGlobalConfig",["VideoPlayerContextSensitiveConfigResolver"],(function(t,n,r,o,a,i,l){var e=new(r("VideoPlayerContextSensitiveConfigResolver")),s={},u=function(t){s=t},c=function(n,r){if(s&&typeof s[n]=="boolean")return s[n];var t=e.getValue(n);return t!=null&&typeof t=="boolean"?t:r},d=function(n,r){if(s&&typeof s[n]=="number")return s[n];var t=e.getValue(n);return t!=null&&typeof t=="number"?t:r},m=function(n,r){if(s&&typeof s[n]=="string")return s[n];var t=e.getValue(n);return t!=null&&typeof t=="string"?t:r};l.setGlobalOverrideConfig=u,l.getBool=c,l.getNumber=d,l.getString=m}),98);
__d("VideoPlayerOzWWWGlobalConfig",["VideoPlayerShakaGlobalConfig"],(function(t,n,r,o,a,i,l){"use strict";var e="oz_www_",s={getBool:function(n,r){return o("VideoPlayerShakaGlobalConfig").getBool(e+n,r)},getNumber:function(n,r){return o("VideoPlayerShakaGlobalConfig").getNumber(e+n,r)},getString:function(n,r){return o("VideoPlayerShakaGlobalConfig").getString(e+n,r)}},u=s;l.default=u}),98);
__d("VideoPlayerImplementationEngineVideoElementAPI",["Promise","VideoPlaybackQuality","VideoPlayerOzWWWGlobalConfig"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(e){return isNaN(e)?0:e}function u(e){return s(e.duration)}function c(e){var t=[];try{for(var n=e.buffered,r=0;r<n.length;++r)t.push({endTime:n.end(r),startTime:n.start(r)})}catch(e){}return t}function d(e){try{var t=e.buffered;if(t.length>0)return t.end(t.length-1)}catch(e){}return 0}function m(e){return s(e.currentTime)}function p(e){try{var t=e.buffered;if(t.length>0)return t.start(0)}catch(e){}return 0}function _(t){return{exitPictureInPicture:function(){window.document.exitPictureInPicture()},getBufferedRanges:function(){return c(t)},getCanPlayPromise:function(){return new(e||(e=n("Promise")))(function(e,n){t.readyState===4?e():t.addEventListener("canplay",function(){return e()})})},getDOMLoadedMetadataPromise:function(){return new(e||(e=n("Promise")))(function(e,n){t.addEventListener("loadedmetadata",function(){return e()})})},getDroppedFrameCount:function(){return o("VideoPlaybackQuality").getDroppedFrames(t)},getDuration:function(){return u(t)},getEnded:function(){return t.ended},getError:function(){return t.error},getLastBufferEndPosition:function(){return d(t)},getMuted:function(){return t.muted},getNetworkState:function(){return t.networkState},getPaused:function(){return t.paused},getPlaybackRate:function(){return t.playbackRate},getPlayheadPosition:function(){return m(t)},getReadyState:function(){return t.readyState},getTotalFrameCount:function(){return o("VideoPlaybackQuality").getTotalFrames(t)},getUnderlyingVideoElement:function(){return t},getVideoPixelsDecodedDimensions:function(){var e=t.videoWidth,n=t.videoHeight;return e<=0||n<=0?null:{height:n,width:e}},getVideoPixelsPaintedDimensions:function(){if(t.readyState<t.HAVE_CURRENT_DATA)return null;var e=t.videoWidth,n=t.videoHeight;if(e<=0||n<=0)return null;var r=t.offsetWidth,o=t.offsetHeight;if(r<=0||o<=0)return null;var a=e/n,i=r/o;return i>a?r=o*a:o=r/a,{height:o,width:r}},getVolume:function(){return t.volume},pause:function(){t.pause()},play:function(){var r=t.play(),o=r&&typeof r.then=="function"?(e||(e=n("Promise"))).resolve(r):null;return o},requestPictureInPicture:function(){typeof t.requestPictureInPicture=="function"&&t.requestPictureInPicture()},setDuration:function(n){t.duration=n},setMuted:function(n){t.muted=n},setPlaybackRate:function(n){t.playbackRate=n},setPlayheadPosition:function(n){var e=n;if(n===0){var o=r("VideoPlayerOzWWWGlobalConfig").getNumber("clamp_seek_to_first_buffer_range_epsilon",0);if(o>0){var a=p(t);a>0&&a<=o&&(e=a)}}t.currentTime=e},setVolume:function(n){t.volume=n}}}l.getDurationFromVideoElement=u,l.getBufferedRangesFromVideoElement=c,l.getLastBufferEndPositionFromVideoElement=d,l.getPlayheadPositionFromVideoElement=m,l.createVideoPlayerImplementationEngineVideoElementAPI=_}),98);
__d("VideoPlayerImplementationErrorNormalization",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t=e.getType(),n=e.getDescription();switch(t){case"OZ_NETWORK":{var r,o,a=(r=(o=e.getExtra())==null?void 0:o.code)!=null?r:"0",i=parseInt(a,10);return i<100||i>599?"NetworkError":"HTTPError"}case"OZ_SOURCE_BUFFER_QUOTA_EXCEEDED":{var l,s=(l=e.getExtra())==null?void 0:l.mimeType;return s!=null&&s.indexOf("video")>-1?"VideoDecodeError":s!=null&&s.indexOf("audio")>-1?"AudioDecodeError":"GenericDecodeError"}case"OZ_XML_PARSER":case"OZ_MPD_PARSER":case"OZ_REPRESENTATION_PARSER":return"ManifestParseError";case"OZ_DRM_MANAGER":case"OZ_INITIALIZATION":return/(OZ_XML_PARSER)|(OZ_MPD_PARSER)|(OZ_REPRESENTATION_PARSER)/.test(n)?"ManifestParseError":"RuntimeError";case"OZ_JAVASCRIPT_NATIVE":case"OZ_SOURCE_BUFFER":case"OZ_STREAM_APPEND_QUOTA_EXCEEDED_HANDLER_ERROR":case"OZ_NETWORK_REQUEST_STREAM_RETRY_HANDLER_ERROR":return"RuntimeError"}return null}function l(e,t){switch(e){case"OZ_XML_PARSER":case"OZ_MPD_PARSER":case"OZ_REPRESENTATION_PARSER":return"ManifestParseError";case"OZ_DRM_MANAGER":case"OZ_INITIALIZATION":return/(OZ_XML_PARSER)|(OZ_MPD_PARSER)|(OZ_REPRESENTATION_PARSER)/.test(t)?"ManifestParseError":"RuntimeError";case"OZ_JAVASCRIPT_NATIVE":case"OZ_SOURCE_BUFFER":case"OZ_STREAM_APPEND_QUOTA_EXCEEDED_HANDLER_ERROR":case"OZ_NETWORK_REQUEST_STREAM_RETRY_HANDLER_ERROR":return"RuntimeError";case"BUFFERING_TIMEOUT":return"RuntimeError";default:{var n=[[["MEDIA_ERR_NETWORK"],"NetworkError"],[["MEDIA_ERR_ABORTED","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_UNKNOWN"],"GenericDecodeError"]];for(var r of n){var o=r[0],a=r[1];if(o.some(function(t){return e.includes(t)}))return a}}}return null}i.getVideoPlayerNormalizedErrorTypeFromOzError=e,i.getErrorTypeFromErrorName=l}),66);
__d("getErrorMessageFromMediaErrorCode",[],(function(t,n,r,o,a,i){"use strict";function e(e){switch(e){case 1:return"The fetching process for the media resource was aborted by the user agent at the users request.";case 2:return"A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.";case 3:return"An error of some description occurred while decoding the media resource, after the resource was established to be usable.";case 4:return"The media resource indicated by the src attribute was not suitable."}return null}i.default=e}),66);
__d("getErrorNameFromMediaErrorCode",[],(function(t,n,r,o,a,i){"use strict";function e(e){switch(e){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return"MEDIA_ERR_UNKNOWN_"+(e!=null?e:"UNDEFINED")}}i.default=e}),66);
__d("getMoreGranularErrorNameFromHTMLVideoElementErrorMessage",[],(function(t,n,r,o,a,i){"use strict";function e(e){var t,n,r=/^([A-Z_]+:)|([A-Z_]+\s+\(0x[0-9A-Fa-f]+\))/.exec(e),o=((t=(n=r==null?void 0:r[1])!=null?n:r==null?void 0:r[2])!=null?t:"").replace(/\s+/,"_").replace(/[^A-Za-z0-9_]/g,"");return o!==""?o:null}i.default=e}),66);
__d("oz-player/utils/OzError",[],(function(t,n,r,o,a,i){"use strict";var e=(function(e){function t(t,n){var r;n===void 0&&(n=0),r=e.call(this,t.description)||this,r.$OzErrorClass$p_1=t,r.name=t.type,r.message=t.description;var o=r.stack;if(!(typeof o=="string"&&o!==""))if(Error.captureStackTrace){var a={};Error.captureStackTrace(a,r.constructor),o=a.stack}else{var i=new Error().stack.split("\n");i.splice(/^Error/.test(i[0])?1:0,1),o="Error\n"+i.join("\n")}return typeof o=="string"&&o!==""?r.stack=o.split("\n").map(function(e,t){return t===0?r.name+": "+r.message.replace(/\n.*/," (...)"):t-1<n?null:e}).filter(Boolean).join("\n"):r.stack="",r}babelHelpers.inheritsLoose(t,e);var n=t.prototype;return n.getExtra=function(){return this.$OzErrorClass$p_1.extra||{}},n.getType=function(){return this.$OzErrorClass$p_1.type},n.getDescription=function(){return this.$OzErrorClass$p_1.description},t})(babelHelpers.wrapNativeSuper(Error));i.OzErrorClass=e}),66);
__d("oz-player/utils/OzErrorUtils",["oz-player/utils/OzError"],(function(t,n,r,o,a,i,l){function e(e){if(typeof e=="object"&&e!=null&&e.stack===void 0)try{throw e}catch(e){}}function s(e){return e instanceof o("oz-player/utils/OzError").OzErrorClass}function u(t,n){var r;n===void 0&&(n=0);var a=new(o("oz-player/utils/OzError")).OzErrorClass(t,1+n);return e(a),e((r=t.extra)==null?void 0:r.originalError),a}function c(e){return u({type:"OZ_CANCELLED",description:"Cancelled: "+e},1)}function d(e){var t=e.description,n=e.requestUrl,r=e.responseStatus,o=e.responseHeaders,a=e.responseBody;return u({type:"OZ_NETWORK",description:t+" Status:"+r+(a!=null?" Body:"+a.length+":"+a.substr(0,200)+(a.length>200?"...":""):""),extra:{code:r.toString(),headers:o,url:n}},1)}function m(t,n){e(t);var r=s(t)?t:null;return u(babelHelpers.extends({},n,{type:r?r.getType():n.type,description:n.description+" - "+(!(t instanceof Error)&&typeof t=="object"&&t!=null&&typeof t.message=="string"?t.message:String(t)),extra:babelHelpers.extends({},n.extra,{originalError:t})}),1)}function p(e,t){return u({type:e.getType(),description:e.getDescription(),extra:babelHelpers.extends({},e.getExtra(),{mimeType:t})})}function _(e){var t,n;return s(e)?(t=e.getExtra().code||"",n=e):(t=e.status!=null&&e.status!==""?e.status.toString():"0",n=u({type:"OZ_NETWORK",description:e.message,extra:{originalError:e,code:t,url:e.url}})),[n,t]}l.isOzError=s,l.createOzError=u,l.createOzCancelledError=c,l.createOzNetworkError=d,l.convertPromiseRejectionReasonToOzError=m,l.getOzErrorWithMIMEType=p,l.getNormalizedErrorAndCode=_}),98);
__d("VideoPlayerImplementationErrors",["VideoPlayerImplementationErrorNormalization","getErrorMessageFromMediaErrorCode","getErrorNameFromMediaErrorCode","getErrorSafe","getMoreGranularErrorNameFromHTMLVideoElementErrorMessage","oz-player/utils/OzErrorUtils"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.errorLocation,n=e.hostCallError,o=e.videoElementError,a=e.videoElementNetworkState,i=e.videoElementReadyState,l=o==null?void 0:o.code,s=n!=null&&typeof n.message=="string"?n.message:null;s==null&&(s=o==null?void 0:o.message),s==null&&l!=null&&(s=r("getErrorMessageFromMediaErrorCode")(l));var u=r("getErrorNameFromMediaErrorCode")(l);return{createdTimestamp:Date.now(),errorLocation:t,errorMessageFormat:(s!=null?s:"Empty error")+("; code: "+(l!=null?l:"undefined"))+("; readyState: "+i)+("; networkState: "+a),errorMessageParams:[],errorName:u,originalError:n}}function s(e,t){var n,o,a=r("getErrorSafe")(e);return{createdTimestamp:Date.now(),errorCode:typeof e=="object"&&e!=null?typeof e.code=="string"?e.code:typeof e.code=="number"?String(e.code):void 0:void 0,errorLocation:t,errorMessageFormat:(n=a.messageFormat)!=null?n:a.message,errorMessageParams:a.messageFormat!=null?(o=a.messageParams)!=null?o:[]:[],errorName:"VideoElementPlayPromiseRejectionReason_"+(a.name||"UnknownError")}}function u(e,t,n,o){var a,i;o===void 0&&(o=null);var l=r("getErrorSafe")(t);return{createdTimestamp:Date.now(),errorCode:null,errorLocation:n,errorMessageFormat:(l.name||"UnknownError")+" "+((a=l.messageFormat)!=null?a:l.message),errorMessageParams:l.messageFormat!=null?(i=l.messageParams)!=null?i:[]:[],errorName:e,stack:l.stack,url:o!=null?o:null}}function c(e,t){if(o("oz-player/utils/OzErrorUtils").isOzError(e)){var n=e,r=n.getExtra();return{createdTimestamp:Date.now(),errorCode:r.code,errorLocation:t,errorMessageFormat:n.getDescription(),errorMessageParams:[],errorName:n.getType(),errorType:o("VideoPlayerImplementationErrorNormalization").getVideoPlayerNormalizedErrorTypeFromOzError(n),stack:n.stack,url:r.url}}else return u("OZ_JAVASCRIPT_NATIVE",e,t)}function d(e,t){var n=r("getMoreGranularErrorNameFromHTMLVideoElementErrorMessage")(e.message),o=n!=null?e.name+"_"+n:e.name,a=e.message,i=[];return{createdTimestamp:Date.now(),errorLocation:t,errorMessageFormat:a,errorMessageParams:i,errorName:o,errorType:"GenericDecodeError"}}l.createVideoPlayerErrorFromHTMLVideoElementError=e,l.createVideoPlayerErrorFromVideoElementPlayPromiseRejectionReason=s,l.createVideoPlayerErrorFromGenericError=u,l.createVideoPlayerErrorFromOzImplementationError=c,l.createVideoPlayerErrorFromOzImplementationVideoNodeError=d}),98);
__d("VideoPlayerODS",["ODS","Random"],(function(t,n,r,o,a,i,l){"use strict";var e,s=function(n,r,a){o("Random").coinflip(a)&&(e||(e=o("ODS"))).bumpEntityKey(2079,n,r,a)};l.bumpEntityKey=s}),98);
__d("VideoPlayerImplementationStateMachine",["FBLogger","VideoPlayerEmsgForStateMachine","VideoPlayerImplementationErrors","VideoPlayerODS","gkx","shallowEqual"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.bufferingDetected,n=e.seeking,r=e.waitingForDomPlaying;return!t&&!n&&!r}function s(t){var n=t.bufferingDetected,o=t.prevPlaybackState,a=t.seeking,i=t.waitingForDomPlaying,l=e({bufferingDetected:n,seeking:a,waitingForDomPlaying:i}),s=o;switch(o){case"stalling":s=l?"playing":"stalling";break;case"ended":case"paused":case"playing":break;default:r("FBLogger")("comet_video_player").mustfix("unexpected playbackState: %s",o);break}return s}function u(e){return e.loopCount>0&&e.loopCurrent<e.loopCount||e.loopCount===-1}function c(e,t,n,a){var i,l;switch(n.type){case"host_call_pause":case"host_call_play":case"host_call_set_current_time":case"host_call_set_volume":case"host_call_set_muted":case"host_call_set_playback_rate":case"host_call_set_video_quality":case"host_call_set_latency_level":return babelHelpers.extends({},e,{hostCallQueue:e.hostCallQueue.concat([n])});case"controller_set_latency_level_requested":case"implementation_set_latency_level_requested":return babelHelpers.extends({},e,{latencyLevel:n.payload.latencyLevel,ullIneligibilityReason:n.payload.ullIneligibilityReason});case"dom_event_loadedmetadata":return babelHelpers.extends({},e,{domEventsLatestPerfMs:babelHelpers.extends({},e.domEventsLatestPerfMs,{clockMs:t.clockTimestamp,loadedmetadata:n.payload.domEventPerfTimestamp,perfMs:t.perfTimestamp})});case"dom_event_loadeddata":return babelHelpers.extends({},e,{domEventsLatestPerfMs:babelHelpers.extends({},e.domEventsLatestPerfMs,{clockMs:t.clockTimestamp,loadeddata:n.payload.domEventPerfTimestamp,perfMs:t.perfTimestamp})});case"dom_event_canplay":return babelHelpers.extends({},e,{domEventsLatestPerfMs:babelHelpers.extends({},e.domEventsLatestPerfMs,{canplay:n.payload.domEventPerfTimestamp,clockMs:t.clockTimestamp,perfMs:t.perfTimestamp})});case"dom_event_ended":return babelHelpers.extends({},e,{playbackState:"ended",waitingForDomPlaying:!1});case"dom_event_pause":return e.playbackState==="ended"?e:t.videoElementEnded===!0?babelHelpers.extends({},e,{playbackState:"ended",waitingForDomPlaying:!1}):e.playbackState==="paused"?e:babelHelpers.extends({},e,{playbackState:"paused",waitingForDomPlaying:!1});case"dom_event_play":{var c=e.playbackState,d=c;switch(c){case"playing":case"stalling":case"ended":case"paused":d="stalling";break;default:r("FBLogger")("comet_video_player").mustfix("unexpected playbackState: %s",c);break}var m=!0;return babelHelpers.extends({},e,{playbackState:d,waitingForDomPlaying:m})}case"dom_event_playing":{var p=e.bufferingDetected,_=e.seeking,f=!1,g=e.playbackState;return babelHelpers.extends({},e,{playbackState:s({bufferingDetected:p,prevPlaybackState:g,seeking:_,waitingForDomPlaying:f}),waitingForDomPlaying:f})}case"dom_event_timeupdate":{var h=o("VideoPlayerEmsgForStateMachine").makeUpdatedActiveEmsgBoxes(e.allEmsgBoxes,t.videoElementPlayheadPosition,e.activeEmsgBoxes);if(e.waitingForDomTimeUpdateAfterSeeked){var y=e.bufferingDetected,C=e.seeking,b=!1,v=e.playbackState;return babelHelpers.extends({},e,{activeEmsgBoxes:h,playbackState:s({bufferingDetected:y,prevPlaybackState:v,seeking:C,waitingForDomPlaying:b}),waitingForDomPlaying:b,waitingForDomTimeUpdateAfterSeeked:!1})}return babelHelpers.extends({},e,{activeEmsgBoxes:h})}case"dom_event_seeking":{var S=e.playbackState,R=S;switch(S){case"paused":case"ended":break;case"stalling":case"playing":R="stalling";break;default:r("FBLogger")("comet_video_player").mustfix("unexpected playbackState: %s",S)}return babelHelpers.extends({},e,{playbackState:R,seeking:!0,waitingForDomPlaying:!0})}case"dom_event_seeked":{var L=e.bufferingDetected,E=e.waitingForDomPlaying,k=!1,I=e.playbackState;return babelHelpers.extends({},e,{implementationSeekSourcePosition:null,playbackState:s({bufferingDetected:L,prevPlaybackState:I,seeking:k,waitingForDomPlaying:E}),seeking:k,waitingForDomTimeUpdateAfterSeeked:!0})}case"dom_event_error":return n.payload.videoElementError==null&&o("VideoPlayerODS").bumpEntityKey("comet_video_player","dom_event_error.error_is_nullish",14),babelHelpers.extends({},e,{playbackState:"paused",waitingForDomPlaying:!1});case"dom_event_play_promise_created":return babelHelpers.extends({},e,{hostCallPlayIDLast:n.payload.hostCallPlayID});case"dom_event_play_promise_resolved":return e.hostCallPlayIDLast!==n.payload.hostCallPlayID?e:babelHelpers.extends({},e,{hostCallPlayIDLast:null});case"dom_event_play_promise_rejected":if(e.hostCallPlayIDLast!==n.payload.hostCallPlayID)return e;if(a==="comet_nextgendash"){var T=n.payload.playPromiseRejectionReason;return babelHelpers.extends({},e,{hostCallPlayIDLast:null},!(T!=null&&T.name==="AbortError")&&e.playbackState==="stalling"?{playbackState:"paused",waitingForDomPlaying:!1}:{})}return babelHelpers.extends({},e,{hostCallPlayIDLast:null,playbackState:e.playbackState==="stalling"?"paused":e.playbackState,waitingForDomPlaying:!1});case"dom_event_durationchange":{if(a==="comet_nextgendash"){var D=t.videoElementEnded===!0?"ended":t.videoElementPaused===!0?"paused":e.playbackState;if((e.playbackState==="stalling"||e.playbackState==="playing")&&D!==e.playbackState)return babelHelpers.extends({},e,{playbackState:D,waitingForDomPlaying:!1})}return e}case"implementation_host_call_queue_flushed":return babelHelpers.extends({},e,{hostCallQueue:[]});case"implementation_host_call_failed":{var x=o("VideoPlayerImplementationErrors").createVideoPlayerErrorFromHTMLVideoElementError({errorLocation:n.payload.errorLocation,hostCallError:n.payload.hostCallError,videoElementError:n.payload.videoElementError,videoElementNetworkState:n.payload.videoElementNetworkState,videoElementReadyState:n.payload.videoElementReadyState});return babelHelpers.extends({},e,{error:x,playbackState:"paused",waitingForDomPlaying:!1})}case"implementation_mounted":return babelHelpers.extends({},e,{mountState:"mounted_onscreen"});case"implementation_unmounted":return babelHelpers.extends({},e,{mountState:"unmounted"});case"implementation_onscreen":return babelHelpers.extends({},e,{mountState:"mounted_onscreen"});case"implementation_offscreen":return babelHelpers.extends({},e,{mountState:"mounted_offscreen"});case"implementation_video_node_unmounted":return babelHelpers.extends({},e,{hostCallPlayIDLast:null});case"implementation_engine_initialized":{var $,P=($=n.payload.streamingFormat)!=null?$:e.streamingFormat;return babelHelpers.extends({},e,{hostCallCanApply:!0,selectedVideoQuality:n.payload.selectedVideoQuality,streamingFormat:P})}case"implementation_engine_qualities_changed":{var N,M=(N=n.payload.streamingFormat)!=null?N:e.streamingFormat;return babelHelpers.extends({},e,{selectedVideoQuality:n.payload.selectedVideoQuality,streamingFormat:M})}case"implementation_engine_destroyed":return babelHelpers.extends({},e,{hostCallPlayIDLast:null});case"implementation_fatal_error":return babelHelpers.extends({},e,{error:n.payload.fatalError,hostCallPlayIDLast:null,playbackState:"paused",waitingForDomPlaying:!1});case"controller_inject_fatal_error":return babelHelpers.extends({},e,{error:n.payload.fatalError,hostCallPlayIDLast:null,playbackState:"paused",waitingForDomPlaying:!1});case"implementation_seek_requested":return babelHelpers.extends({},e,{implementationSeekSourcePosition:n.payload.seekSourcePosition});case"representation_changed":return babelHelpers.extends({},e);case"controller_pause_requested":return e.playbackState==="ended"?e:babelHelpers.extends({},e,{lastPausedTimeMs:Date.now(),lastPauseReason:n.payload.reason,lastPlayedTimeMs:0,playbackState:"paused",waitingForDomPlaying:!1,watchTimeMs:e.lastPlayedTimeMs>0?e.watchTimeMs+(Date.now()-e.lastPlayedTimeMs):e.watchTimeMs});case"controller_play_requested":return e.playbackState!=="paused"&&e.playbackState!=="ended"?e:babelHelpers.extends({},e,{hasPlayEverBeenRequested:!0,lastPlayedTimeMs:e.lastPlayedTimeMs===0?Date.now():e.lastPlayedTimeMs,lastPlayReason:n.payload.reason,loopCurrent:u(e)?n.payload.reason==="loop_initiated"?e.loopCurrent+1:e.loopCurrent:0,playbackState:"stalling",waitingForDomPlaying:!0});case"controller_seek_requested":return babelHelpers.extends({},e,{implementationSeekSourcePosition:(i=t.videoElementPlayheadPosition)!=null?i:e.implementationSeekSourcePosition,seeking:!0,seekTargetPosition:n.payload.seekTargetPosition});case"controller_quality_requested":return babelHelpers.extends({},e,{selectedVideoQuality:n.payload.selectedVideoQuality});case"controller_video_variant_requested":return babelHelpers.extends({},e,{selectedVideoVariant:n.payload.selectedVideoVariant});case"controller_set_caption_display_style_requested":return babelHelpers.extends({},e,{captionDisplayStyle:n.payload.captionDisplayStyle});case"controller_set_picture_in_picture_state_requested":return babelHelpers.extends({},e,{isDesktopPictureInPicture:n.payload.isInPictureInPictureMode});case"controller_set_caption_format_requested":return babelHelpers.extends({},e,{captionFormat:n.payload.captionFormat});case"controller_set_playback_rate":return babelHelpers.extends({},e,{targetPlaybackRate:n.payload.playbackRate});case"controller_muted_requested":return babelHelpers.extends({},e,{lastMuteReason:n.payload.reason,muted:n.payload.muted});case"controller_volume_requested":return babelHelpers.extends({},e,{volume:n.payload.volume});case"controller_scrub_begin_requested":return e.scrubbing?e:babelHelpers.extends({},e,{scrubbing:!0,seekTargetPosition:null});case"controller_scrub_end_requested":return e.scrubbing?babelHelpers.extends({},e,{implementationSeekSourcePosition:(l=t.videoElementPlayheadPosition)!=null?l:e.implementationSeekSourcePosition,scrubbing:!1,seeking:n.payload.seekTargetPosition!=null,seekTargetPosition:n.payload.seekTargetPosition}):e;case"buffering_begin_requested":{var w=e.playbackState,A=w;switch(w){case"paused":case"ended":break;case"playing":case"stalling":A="stalling";break;default:r("FBLogger")("comet_video_player").mustfix("unexpected playbackState: %s",w);break}var F=n.payload.bufferingType;return babelHelpers.extends({},e,{bufferingDetected:!0,lastBufferingType:F,playbackState:A})}case"buffering_end_requested":{var O=e.seeking,B=e.waitingForDomPlaying,W=!1,q=e.playbackState;return babelHelpers.extends({},e,{bufferingDetected:W,playbackState:s({bufferingDetected:W,prevPlaybackState:q,seeking:O,waitingForDomPlaying:B})})}case"controller_set_captions_visible_requested":{var U=n.payload.captionsVisible;return e.captionsVisible===U?e:babelHelpers.extends({},e,{activeCaptions:U?e.activeCaptions:null,captionsLocale:U?e.captionsLocale:null,captionsVisible:U})}case"controller_set_active_captions_requested":{var V,H,G=n.payload.activeCaptions,z=(V=G==null?void 0:G.rows)!=null?V:[],j=n.payload.captionsLocale,K=e.activeCaptions,Q=(H=K==null?void 0:K.rows)!=null?H:[];return Q.length===z.length&&z.every(function(e,t){return Q[t]===e})?e:babelHelpers.extends({},e,{activeCaptions:G,captionsLocale:j})}case"captions_loaded":return babelHelpers.extends({},e,{activeCaptions:e.activeCaptions,captionsLoaded:!0});case"captions_unloaded":return babelHelpers.extends({},e,{activeCaptions:null,captionsLoaded:!1,captionsLocale:null});case"inband_captions_autogenerated_changed":{var X=n.payload.inbandCaptionsAutogenerated;return e.inbandCaptionsAutogenerated===X?e:babelHelpers.extends({},e,{inbandCaptionsAutogenerated:X})}case"stream_ended":return babelHelpers.extends({},e,{streamEnded:!0});case"stream_gone_before_start":return babelHelpers.extends({},e,{playbackState:"ended",streamEnded:!0,waitingForDomPlaying:!1});case"stream_interrupted":return babelHelpers.extends({},e,{streamInterrupted:!0});case"stream_resumed":return babelHelpers.extends({},e,{streamInterrupted:!1});case"seekable_ranges_changed":var Y=n.payload.seekableRanges;return babelHelpers.extends({},e,{seekableRanges:Y});case"controller_set_is_live_rewind_active_requested":var J=n.payload.isLiveRewindActive;return babelHelpers.extends({},e,{isLiveRewindActive:J});case"loop_count_change_requested":var Z=n.payload.loopCount;return Z===e.loopCount?e:babelHelpers.extends({},e,{loopCount:Z,loopCurrent:0});case"player_dimensions_changed":{var ee=n.payload.dimensions,te=ee.height,ne=ee.width;return ne===e.dimensions.width&&te===e.dimensions.height?e:babelHelpers.extends({},e,{dimensions:{height:te,width:ne}})}case"emsg_boxes_parsed":{var re=o("VideoPlayerEmsgForStateMachine").makeUpdatedAllEmsgBoxes(e.allEmsgBoxes,n.payload.emsgBoxes),oe=o("VideoPlayerEmsgForStateMachine").makeUpdatedActiveEmsgBoxes(re,t.videoElementPlayheadPosition,e.activeEmsgBoxes);return babelHelpers.extends({},e,{activeEmsgBoxes:oe,allEmsgBoxes:re})}case"register_emsg_observer":{var ae=new Set(e.emsgObserverTokens);return ae.add(n.payload.token),babelHelpers.extends({},e,{emsgObserverTokens:ae})}case"unregister_emsg_observer":{var ie=new Set(e.emsgObserverTokens);return ie.delete(n.payload.token),babelHelpers.extends({},e,{emsgObserverTokens:ie})}default:return e}}function d(e,t,n){var o=t.type!=="dom_seeking",a=o?n:e.uncontrolledState,i=!r("shallowEqual")(a,e.uncontrolledState),l=c(e.controlledState,a,t,e.playerVersion),s=!r("shallowEqual")(l,e.controlledState);return i||s?babelHelpers.extends({},e,{controlledState:s?l:e.controlledState,uncontrolledState:i?a:e.uncontrolledState}):e}var m,p;function _(e){var t=e.collectUncontrolledState,n=e.debugLogId,o=e.initialState,a=e.onDispatched,i=e.onFatalError,l=o,s=l,u=0,c=!1,m=!1,p=!0,_=!0;return{dispatch:function(n){if(_){var e=null,o=null;try{if(++u,u>=10){if(c)return;throw c=!0,r("FBLogger")("comet_video_player").mustfixThrow("Video player state machine loop detected")}var l=s.uncontrolledState;if(p)try{l=t()}catch(e){p=!1,o=e}var f=s,g=d(f,n,l);s=g,a(f,g,n)}catch(t){_=!1,e=t}finally{if(!m&&(e!=null||o!=null)){m=!0;try{i(e!=null?e:o)}catch(e){}}--u}}},getCurrentState:function(){return s},getInitialState:function(){return l}}}var f,g;function h(e){var t=e.collectUncontrolledState,n=e.debugLogId,r=e.initialState,o=e.onFatalError,a=e.stateTransitionHandlers;function i(e,t,n){try{for(var r=!0,o=0;r&&o<a.length;){var i=a[o];r=i(e,t,n),++o}}finally{}}return _({collectUncontrolledState:t,debugLogId:n,initialState:r,onDispatched:i,onFatalError:o})}function y(e,t){function n(){}function r(e){return e}function o(n){return function(o){var a=o.currentTarget;t(a,["reactEvent("+o.type+")"]),e.dispatch(n)}}function a(n){return function(o){var a=o.currentTarget;t(a,["reactEvent("+o.type+")"]),e.dispatch(n(o,a))}}return{onAbort:n,onCanPlay:a(function(e){return{payload:{domEventPerfTimestamp:e.timeStamp},type:"dom_event_canplay"}}),onCanPlayThrough:n,onDurationChange:o({type:"dom_event_durationchange"}),onEmptied:n,onEncrypted:n,onEnded:o({type:"dom_event_ended"}),onError:a(function(e,t){return{payload:{videoElementError:t.error,videoElementNetworkState:t.networkState,videoElementReadyState:t.readyState},type:"dom_event_error"}}),onLoadedData:a(function(e){return{payload:{domEventPerfTimestamp:e.timeStamp},type:"dom_event_loadeddata"}}),onLoadedMetadata:a(function(e){return{payload:{domEventPerfTimestamp:e.timeStamp},type:"dom_event_loadedmetadata"}}),onLoadStart:n,onPause:o({type:"dom_event_pause"}),onPlay:o({type:"dom_event_play"}),onPlaying:a(function(e){return{payload:{domEventPerfTimestamp:e.timeStamp},type:"dom_event_playing"}}),onProgress:o({type:"dom_event_progress"}),onRateChange:o({type:"dom_event_ratechange"}),onSeeked:o({type:"dom_event_seeked"}),onSeeking:o({type:"dom_event_seeking"}),onStalled:n,onSuspend:n,onTimeUpdate:o({type:"dom_event_timeupdate"}),onVolumeChange:o({type:"dom_event_volumechange"}),onWaiting:o({type:"dom_event_waiting"})}}l.createVideoPlayerImplementationStateMachine=_,l.createVideoPlayerImplementationStateMachineWithStateTransitionHandlers=h,l.createReactVideoElementCallbacksForStateMachine=y}),98);
__d("convertToViewabilityPercentage",[],(function(t,n,r,o,a,i){"use strict";function e(e){return e>=.99?100:e>=.75?75:e>=.5?50:e>=.25?25:e>=0?0:-2}i.default=e}),66);
__d("VideoPlayerImplementationStateMachineStateUncontrolledState",["NetworkStatus","convertToViewabilityPercentage","gkx","performance"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var n,o,a,i,l,s,u,c,d=t.engineExtrasAPI,m=t.fullscreenControllerRef,p=t.videoElementAPI,_=t.videoLiveTraceRef,f=t.videoPlayerPassiveViewabilityInfo,g=_.current,h=Date.now(),y=typeof(e||(e=r("performance"))).now=="function"?(e||(e=r("performance"))).now():0;if(p==null){var C;return{audioRepresentationID:void 0,availableAudioTracks:[],availableQualities:[],availableVideoTracks:[],clockTimestamp:h,currentPlayingAudioTrackID:void 0,currentPlayingVideoQuality:void 0,currentPlayingVideoTrackID:void 0,estimatedBandwidth:void 0,isDocumentHidden:document.hidden,isDRM:void 0,isFBIsLiveTemplated:void 0,isFBMS:void 0,isFBWasLive:void 0,isFullscreen:m.current?m.current.getIsFullscreen():void 0,isLiveRewindAvailable:void 0,isMixedCodecManifest:null,isPredictiveDash:void 0,liveTraceContext:g&&(C=g.getLiveTraceContext())!=null?C:void 0,manifestIdentifier:void 0,mpdValidationErrors:void 0,networkConnected:void 0,perfTimestamp:y,targetAudioTrack:null,targetVideoQuality:"",videoElementDebugCurrentSrc:void 0,videoElementDebugSrc:void 0,videoElementDroppedFrameCount:void 0,videoElementDuration:void 0,videoElementEnded:void 0,videoElementError:void 0,videoElementLastBufferEndPosition:void 0,videoElementMuted:void 0,videoElementNetworkState:void 0,videoElementPaused:void 0,videoElementPlaybackRate:void 0,videoElementPlayheadPosition:void 0,videoElementReadyState:void 0,videoElementTotalFrameCount:void 0,videoElementVolume:void 0,videoProjection:void 0,videoRepresentationID:void 0,viewabilityPercentage:void 0}}var b=p.getPlayheadPosition(),v=f.getCurrent();return{audioRepresentationID:d?d.getCurrentPlayingAudioRepresentationID():void 0,availableAudioTracks:(n=d==null?void 0:d.getAvailableAudioTracks())!=null?n:[],availableQualities:(o=d==null?void 0:d.getAvailableVideoQualities())!=null?o:[],availableVideoTracks:(a=d==null?void 0:d.getAvailableVideoTracks())!=null?a:[],clockTimestamp:h,currentPlayingAudioTrackID:d?d.getCurrentPlayingAudioRepresentationID():void 0,currentPlayingVideoQuality:d?d.getCurrentPlayingVideoQuality():void 0,currentPlayingVideoTrackID:d?d.getCurrentPlayingVideoRepresentationID():void 0,estimatedBandwidth:d?d.getEstimatedBandwidth():void 0,isDocumentHidden:document.hidden,isDRM:d?d.isDrm():void 0,isFBIsLiveTemplated:d?d.isFBIsLiveTemplated():void 0,isFBMS:d?d.isFBMS():void 0,isFBWasLive:d?d.isFBWasLive():void 0,isFullscreen:m.current?m.current.getIsFullscreen():void 0,isLiveRewindAvailable:d?d.isLiveRewindAvailable():void 0,isMixedCodecManifest:d?d.isMixedCodecManifest():null,isPredictiveDash:d?d.isPredictiveDash():void 0,liveTraceContext:g&&(i=g.getLiveTraceContext())!=null?i:void 0,manifestIdentifier:d?d.getManifestIdentifier():void 0,mpdValidationErrors:d?d.getMpdValidationErrors():void 0,networkConnected:r("NetworkStatus").isOnline(),perfTimestamp:y,targetAudioTrack:(l=d==null?void 0:d.getTargetAudioTrack())!=null?l:null,targetVideoQuality:(s=d==null?void 0:d.getCurrentTargetVideoQuality())!=null?s:"",videoElementDebugCurrentSrc:r("gkx")("24351")?(u=p.getUnderlyingVideoElement())==null?void 0:u.currentSrc:void 0,videoElementDebugSrc:r("gkx")("24351")?(c=p.getUnderlyingVideoElement())==null?void 0:c.src:void 0,videoElementDroppedFrameCount:p.getDroppedFrameCount(),videoElementDuration:p.getDuration(),videoElementEnded:p.getEnded(),videoElementError:p.getError(),videoElementLastBufferEndPosition:p.getLastBufferEndPosition(),videoElementMuted:p.getMuted(),videoElementNetworkState:p.getNetworkState(),videoElementPaused:p.getPaused(),videoElementPlaybackRate:p.getPlaybackRate(),videoElementPlayheadPosition:b,videoElementReadyState:p.getReadyState(),videoElementTotalFrameCount:p.getTotalFrameCount(),videoElementVolume:p.getVolume(),videoProjection:d==null?void 0:d.getVideoProjectionType(),videoRepresentationID:d?d.getCurrentPlayingVideoRepresentationID():void 0,viewabilityPercentage:v?r("convertToViewabilityPercentage")(v.visiblePercentage):void 0}}l.createVideoPlayerImplementationStateMachineStateUncontrolledState=s}),98);
__d("VideoPlayerImplementationStateMachineState",["VideoPlayerImplementationStateMachineStateUncontrolledState"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=e.alwaysShowCaptions,n=e.areCaptionsAutogenerated,r=e.captionDisplayStyle,a=e.dimensions,i=e.isAbrEnabled,l=e.playerVersion,s=e.streamingFormat,u=e.videoPlayerPassiveViewabilityInfo,c=!0,d=1,m=o("VideoPlayerImplementationStateMachineStateUncontrolledState").createVideoPlayerImplementationStateMachineStateUncontrolledState({engineExtrasAPI:null,fullscreenControllerRef:{current:null},videoElementAPI:null,videoLiveTraceRef:{current:null},videoPlayerPassiveViewabilityInfo:u});return{controlledState:{activeCaptions:null,activeEmsgBoxes:[],allEmsgBoxes:new Map,bufferingDetected:!1,captionDisplayStyle:r,captionFormat:null,captionsLoaded:!1,captionsLocale:null,captionsVisible:t,dimensions:a,domEventsLatestPerfMs:{},emsgObserverTokens:new Set,error:null,hasPlayEverBeenRequested:!1,hostCallCanApply:!1,hostCallPlayIDLast:null,hostCallQueue:[],implementationSeekSourcePosition:null,inbandCaptionsAutogenerated:n,isDesktopPictureInPicture:!1,isLiveRewindActive:!1,lastBufferingType:null,lastMuteReason:null,lastPausedTimeMs:0,lastPauseReason:null,lastPlayedTimeMs:0,lastPlayReason:null,latencyLevel:"normal",loopCount:0,loopCurrent:0,mountState:"before_mounted",muted:c,playbackState:"paused",scrubbing:!1,seekableRanges:null,seeking:!1,seekTargetPosition:null,selectedVideoQuality:"notselected",selectedVideoVariant:null,streamEnded:!1,streamingFormat:s,streamInterrupted:!1,targetPlaybackRate:1,ullIneligibilityReason:null,volume:d,waitingForDomPlaying:!1,waitingForDomTimeUpdateAfterSeeked:!1,watchTimeMs:0},isAbrEnabled:i,playerVersion:l,uncontrolledState:m}}l.createVideoPlayerImplementationStateMachineInitialState=e}),98);
__d("WASmaxInPrivatestatsIQErrorBadRequestMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","bad-request");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",400);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorBadRequestMixin=e}),98);
__d("WASmaxInPrivatestatsIQErrorFeatureNotImplementedMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","feature-not-implemented");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",501);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorFeatureNotImplementedMixin=e}),98);
__d("WASmaxInPrivatestatsIQErrorInternalServerErrorMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","internal-server-error");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",500);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorInternalServerErrorMixin=e}),98);
__d("WASmaxInPrivatestatsIQErrorResponseMixin",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!r.success)return r;var a=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",r.value);if(!a.success)return a;var i=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!i.success)return i;var l=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",i.value);if(!l.success)return l;var s=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","error");return s.success?o("WAResultOrError").makeResult({type:s.value}):s}l.parseIQErrorResponseMixin=e}),98);
__d("WASmaxInPrivatestatsIQErrorServiceUnavailableMixin",["WAResultOrError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxParseUtils").assertTag(e,"error");if(!t.success)return t;var n=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"text","service-unavailable");if(!n.success)return n;var r=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrInt,e,"code",503);return r.success?o("WAResultOrError").makeResult({text:n.value,code:r.value}):r}l.parseIQErrorServiceUnavailableMixin=e}),98);
__d("WASmaxInPrivatestatsSignCredentialNoRetryError",["WAResultOrError","WASmaxInPrivatestatsIQErrorBadRequestMixin","WASmaxInPrivatestatsIQErrorFeatureNotImplementedMixin","WASmaxInPrivatestatsIQErrorServiceUnavailableMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e){var t=o("WASmaxInPrivatestatsIQErrorBadRequestMixin").parseIQErrorBadRequestMixin(e);if(t.success)return o("WAResultOrError").makeResult({name:"IQErrorBadRequest",value:t.value});var n=o("WASmaxInPrivatestatsIQErrorFeatureNotImplementedMixin").parseIQErrorFeatureNotImplementedMixin(e);if(n.success)return o("WAResultOrError").makeResult({name:"IQErrorFeatureNotImplemented",value:n.value});var r=o("WASmaxInPrivatestatsIQErrorServiceUnavailableMixin").parseIQErrorServiceUnavailableMixin(e);return r.success?o("WAResultOrError").makeResult({name:"IQErrorServiceUnavailable",value:r.value}):o("WASmaxParseUtils").errorMixinDisjunction(e,["IQErrorBadRequest","IQErrorFeatureNotImplemented","IQErrorServiceUnavailable"],[t,n,r])}l.parseSignCredentialNoRetryError=e}),98);
__d("WASmaxInPrivatestatsSignCredentialResponseErrorNoRetry",["WAResultOrError","WASmaxInPrivatestatsIQErrorResponseMixin","WASmaxInPrivatestatsSignCredentialNoRetryError","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInPrivatestatsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);if(!a.success)return a;var i=o("WASmaxInPrivatestatsSignCredentialNoRetryError").parseSignCredentialNoRetryError(r.value);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({},a.value,{errorSignCredentialNoRetryError:i.value})):i}l.parseSignCredentialResponseErrorNoRetry=e}),98);
__d("WASmaxInPrivatestatsSignCredentialResponseErrorRetry",["WAResultOrError","WASmaxInPrivatestatsIQErrorInternalServerErrorMixin","WASmaxInPrivatestatsIQErrorResponseMixin","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"error");if(!r.success)return r;var a=o("WASmaxInPrivatestatsIQErrorInternalServerErrorMixin").parseIQErrorInternalServerErrorMixin(r.value);if(!a.success)return a;var i=o("WASmaxInPrivatestatsIQErrorResponseMixin").parseIQErrorResponseMixin(e,t);return i.success?o("WAResultOrError").makeResult(babelHelpers.extends({errorIQErrorInternalServerErrorMixin:a.value},i.value)):i}l.parseSignCredentialResponseErrorRetry=e}),98);
__d("WASmaxInPrivatestatsSignCredentialResponseSuccess",["WAResultOrError","WASmaxParseReference","WASmaxParseUtils"],(function(t,n,r,o,a,i,l){function e(e,t){var n=o("WASmaxParseUtils").assertTag(e,"iq");if(!n.success)return n;var r=o("WASmaxParseUtils").flattenedChildWithTag(e,"sign_credential");if(!r.success)return r;var a=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"signed_credential");if(!a.success)return a;var i=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"acs_public_key");if(!i.success)return i;var l=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"dleq_proof");if(!l.success)return l;var s=o("WASmaxParseUtils").flattenedChildWithTag(l.value,"c");if(!s.success)return s;var u=o("WASmaxParseUtils").flattenedChildWithTag(l.value,"s");if(!u.success)return u;var c=o("WASmaxParseUtils").flattenedChildWithTag(r.value,"project_name");if(!c.success)return c;var d=o("WASmaxParseReference").attrStringFromReference(t,["id"]);if(!d.success)return d;var m=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"id",d.value);if(!m.success)return m;var p=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"type","result");if(!p.success)return p;var _=o("WASmaxParseReference").attrStringFromReference(t,["to"]);if(!_.success)return _;var f=o("WASmaxParseUtils").literal(o("WASmaxParseUtils").attrString,e,"from",_.value);if(!f.success)return f;var g=o("WASmaxParseUtils").attrIntRange(r.value,"t",0,void 0);if(!g.success)return g;var h=o("WASmaxParseUtils").contentBytesRange(a.value,32,32);if(!h.success)return h;var y=o("WASmaxParseUtils").contentBytesRange(i.value,32,32);if(!y.success)return y;var C=o("WASmaxParseUtils").contentBytesRange(s.value,32,32);if(!C.success)return C;var b=o("WASmaxParseUtils").contentBytesRange(u.value,32,32);if(!b.success)return b;var v=o("WASmaxParseUtils").contentString(c.value);return v.success?o("WAResultOrError").makeResult({type:p.value,signCredentialT:g.value,signCredentialSignedCredentialElementValue:h.value,signCredentialAcsPublicKeyElementValue:y.value,signCredentialDleqProofCElementValue:C.value,signCredentialDleqProofSElementValue:b.value,signCredentialProjectNameElementValue:v.value}):v}l.parseSignCredentialResponseSuccess=e}),98);
__d("WASmaxOutPrivatestatsSignCredentialRequest",["WASmaxJsx","WAWap"],(function(t,n,r,o,a,i,l){function e(e){var t,n=e.blindedCredentialElementValue,r=e.projectNameElementValue,a=(t=o("WASmaxJsx")).smax("iq",{xmlns:"privatestats",id:o("WAWap").generateId(),type:"get",to:o("WAWap").S_WHATSAPP_NET},t.smax("sign_credential",{version:"2"},t.smax("blinded_credential",null,n),t.smax("project_name",null,r)));return a}l.makeSignCredentialRequest=e}),98);
__d("WASmaxPrivatestatsSignCredentialRPC",["WAComms","WASmaxInPrivatestatsSignCredentialResponseErrorNoRetry","WASmaxInPrivatestatsSignCredentialResponseErrorRetry","WASmaxInPrivatestatsSignCredentialResponseSuccess","WASmaxOutPrivatestatsSignCredentialRequest","WASmaxParsingFailure","WASmaxRpcUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=o("WASmaxOutPrivatestatsSignCredentialRequest").makeSignCredentialRequest(e),r=yield o("WAComms").sendSmaxStanza(n,t),a=o("WASmaxInPrivatestatsSignCredentialResponseSuccess").parseSignCredentialResponseSuccess(r,n);if(a.success)return{name:"SignCredentialResponseSuccess",value:a.value};var i=o("WASmaxInPrivatestatsSignCredentialResponseErrorNoRetry").parseSignCredentialResponseErrorNoRetry(r,n);if(i.success)return{name:"SignCredentialResponseErrorNoRetry",value:i.value};var l=o("WASmaxInPrivatestatsSignCredentialResponseErrorRetry").parseSignCredentialResponseErrorRetry(r,n);if(l.success)return{name:"SignCredentialResponseErrorRetry",value:l.value};throw new(o("WASmaxParsingFailure")).SmaxParsingFailure(o("WASmaxRpcUtils").errorMessageRpcParsing("SignCredential",{Success:a,ErrorNoRetry:i,ErrorRetry:l}))}),s.apply(this,arguments)}l.sendSignCredentialRPC=e}),98);
__d("WAWebCRUDOperationsACSTokens",["WAWebSchemaACSTokens","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return t===void 0&&(t=o("WAWebSchemaACSTokens").getACSTokensTable()),t.createOrReplace(e)}function s(t,n){var r=t+"-default";return e(babelHelpers.extends({project:t},n,{tokenName:r}))}function u(e,t){var n=t.map(function(t,n){return babelHelpers.extends({},t,{project:e,tokenName:e+"-"+n})});return o("WAWebSchemaACSTokens").getACSTokensTable().bulkCreateOrReplace(n)}function c(e,t){return t===void 0&&(t=o("WAWebSchemaACSTokens").getACSTokensTable()),t.anyOf(["project"],[e])}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t===void 0&&(t=o("WAWebSchemaACSTokens").getACSTokensTable());var n=yield c(e,t);return n.length>0?n[0]:null}),m.apply(this,arguments)}function p(e){return o("WAWebSchemaACSTokens").getACSTokensTable().get(e)}function _(e,t){return f.apply(this,arguments)}function f(){return f=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield c(e,t);yield t.bulkRemove(n.map(function(e){return e.tokenName}))}),f.apply(this,arguments)}l.upsertACSToken=e,l.storeACSTokenForProject=s,l.storeACSTokensForProject=u,l.getACSTokensByProject=c,l.getACSTokenByProject=d,l.getACSTokenByName=p,l.deleteAllACSTokensByProject=_}),98);
__d("WAWebFetchACSTokens",["WAPromiseRetryLoop","WASmaxPrivatestatsSignCredentialRPC","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e=3;function s(e,t){return u.apply(this,arguments)}function u(){return u=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){return o("WASmaxPrivatestatsSignCredentialRPC").sendSignCredentialRPC({projectNameElementValue:e,blindedCredentialElementValue:t})}),u.apply(this,arguments)}function c(e,t){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,r){var a=1,i=(function(){var o=n("asyncToGeneratorRuntime").asyncToGenerator(function*(n){var o=yield s(t,r);switch(o.name){case"SignCredentialResponseErrorNoRetry":return n({result:null});case"SignCredentialResponseErrorRetry":return a+=1,a>e?n({result:null}):void 0;default:return o.name,n({result:o.value})}});return function(t){return o.apply(this,arguments)}})(),l=new(o("WAPromiseRetryLoop")).PromiseRetryLoop({name:"issueACSTokenForProject-"+t,timer:{algo:{type:"exponential",first:250},max:1e3},code:i});return l.start(),l.promise()}),d.apply(this,arguments)}l.fetchACSTokenForProject=s,l.fetchACSTokenForProjectWithRetry=c}),98);
__d("WAWebACSTokenConfig",["WATimeUtils","keyMirror"],(function(t,n,r,o,a,i,l){"use strict";var e={WA_StatusMusic:{getMaxRedeemCount:function(){return 50},getMaxExpirySeconds:function(){return o("WATimeUtils").DAY_SECONDS}},WA_StatusMusicReporting:{getMaxRedeemCount:function(){return 50},getMaxExpirySeconds:function(){return o("WATimeUtils").DAY_SECONDS}},WA_ChannelsForwardCounter:{getMaxRedeemCount:function(){return 64},getMaxExpirySeconds:function(){return o("WATimeUtils").DAY_SECONDS}}};function s(t){return{maxRedeemCount:e[t].getMaxRedeemCount(),maxExpirySeconds:e[t].getMaxExpirySeconds()}}var u=r("keyMirror")(e);l.getACSTokenConfig=s,l.ACS_PROJECTS=u}),98);
__d("WAWebACSTokenUtils",["WALogger","WATimeUtils","WAWebACSTokenConfig"],(function(t,n,r,o,a,i,l){"use strict";var e,s;function u(t){var n=t.redeemCount,r=t.creationTs,a=t.projectName,i=o("WAWebACSTokenConfig").getACSTokenConfig(a),l=i.maxExpirySeconds,u=i.maxRedeemCount;return o("WATimeUtils").happenedWithin(r,l)?n>=u?(o("WALogger").LOG(s||(s=babelHelpers.taggedTemplateLiteralLoose(["The "," ACS token was redeemed maximum number of time. The client shall re-issue a new one"])),a),!1):!0:(o("WALogger").LOG(e||(e=babelHelpers.taggedTemplateLiteralLoose(["The "," ACS token expired. The client shall re-issue a new one"])),a),!1)}l.isValidACSToken=u}),98);
__d("WAWebRedeemACSTokenFromStorage",["WAWebACSTokenUtils","WAWebCRUDOperationsACSTokens","WAWebModelStorageUtils","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){return o("WAWebModelStorageUtils").getStorage().lock(["acs-tokens"],(function(){var t=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){var n=t[0],r=yield o("WAWebCRUDOperationsACSTokens").getACSTokensByProject(e,n);if(r.length===0)return null;var a=r.filter(function(t){return o("WAWebACSTokenUtils").isValidACSToken({creationTs:t.creationTs,projectName:e,redeemCount:t.redeemCount})});if(a.length===0)return yield o("WAWebCRUDOperationsACSTokens").deleteAllACSTokensByProject(e,n),null;var i=u(a);if(i==null)return null;var l=i.redeemCount+1;return yield o("WAWebCRUDOperationsACSTokens").upsertACSToken(babelHelpers.extends({},i,{redeemCount:l}),n),i.token});return function(e){return t.apply(this,arguments)}})())}),s.apply(this,arguments)}function u(e){var t=Math.min.apply(Math,e.map(function(e){return e.redeemCount}));return e.find(function(e){return e.redeemCount===t})}l.redeemACSTokenFromStorage=e}),98);
__d("WAWebRedeemACSToken",["Promise","WAACSTokenUtils","WATimeUtils","WAWamPrivateStatsToken","WAWebCRUDOperationsACSTokens","WAWebFetchACSTokens","WAWebRedeemACSTokenFromStorage","asyncToGeneratorRuntime","compactMap"],(function(t,n,r,o,a,i,l){"use strict";var e,s=5;function u(e){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.projectName,n=yield o("WAWebRedeemACSTokenFromStorage").redeemACSTokenFromStorage(t);if(n!=null)return n;var r=yield d(t);if(r.length!==0){var a=r[0],i=babelHelpers.arrayLikeToArray(r).slice(1),l=a.sharedSecret,s=a.token,u=a.t;return yield o("WAWebCRUDOperationsACSTokens").storeACSTokenForProject(t,{creationTs:u,redeemCount:1,token:{sharedSecret:l,token:s}}),yield o("WAWebCRUDOperationsACSTokens").storeACSTokensForProject(t,i.map(function(e){var t=e.sharedSecret,n=e.token,r=e.t;return{token:{sharedSecret:t,token:n},creationTs:r,redeemCount:0}})),{sharedSecret:l,token:s}}}),c.apply(this,arguments)}function d(e,t){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t,o){o===void 0&&(o=s);var a=Array.from({length:o}).fill().map(function(){return p(t)}),i=yield(e||(e=n("Promise"))).allSettled(a),l=i.filter(function(e){return e.status==="fulfilled"});return r("compactMap")(l,function(e){return e.value})}),m.apply(this,arguments)}function p(e){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=o("WAACSTokenUtils").getBlindedToken(),n=t.token,r=t.blindedToken,a=t.blindingFactor,i=yield o("WAWebFetchACSTokens").fetchACSTokenForProjectWithRetry(e,r);if(i.result!=null){var l=i.result,s=l.signCredentialAcsPublicKeyElementValue,u=l.signCredentialSignedCredentialElementValue,c=l.signCredentialT,d=o("WAWamPrivateStatsToken").unblindToken(u,a,s);if(d!=null){var m=o("WAACSTokenUtils").getSharedSecret({token:n,unblindedSignedToken:d});return{token:n,sharedSecret:m,t:o("WATimeUtils").castToUnixTime(c)}}}}),_.apply(this,arguments)}l.redeemACSToken=u}),98);
__d("WAWebRedeemACSCredential",["WABase64","WACryptoHmac","WAWebRedeemACSToken","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){t===void 0&&(t=new ArrayBuffer(0));var n=yield o("WAWebRedeemACSToken").redeemACSToken({projectName:e});if(n!=null){var r=o("WABase64").encodeB64UrlSafe(n.token,!0),a=yield o("WACryptoHmac").hmacSha256(n.sharedSecret,t),i=o("WABase64").encodeB64UrlSafe(a,!0),l=r+"+"+i;return l}}),s.apply(this,arguments)}l.redeemACSCredential=e}),98);
__d("WAWebACSNetwork",["WAWebHttpExtendedFetch","WAWebRedeemACSCredential","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return s.apply(this,arguments)}function s(){return s=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.url,n=e.project,r=e.data,a=yield u(n,r);return o("WAWebHttpExtendedFetch").extendedFetch(t,{body:a,method:"POST"})}),s.apply(this,arguments)}function u(e,t){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,t){var n=yield o("WAWebRedeemACSCredential").redeemACSCredential(e);if(n==null)throw r("err")("Failed to redeem ACS credential");return t.set("acs_token",n),t.set("acs_project",e),t}),c.apply(this,arguments)}l.fetchWithACSCredential=e,l.addACSCredential=u}),98);
__d("WAWebCRUDOperationsMediaPlaybackEvent",["WAWebSchemaMediaPlaybackEvent","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return o("WAWebSchemaMediaPlaybackEvent").getMediaPlaybackEventTable().bulkCreateOrReplace(e.map(function(e){return{event:e}}))}function s(e){return o("WAWebSchemaMediaPlaybackEvent").getMediaPlaybackEventTable().all({limit:e,offset:0})}function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){return o("WAWebSchemaMediaPlaybackEvent").getMediaPlaybackEventTable().count()}),c.apply(this,arguments)}function d(e){return o("WAWebSchemaMediaPlaybackEvent").getMediaPlaybackEventTable().bulkRemove(e)}l.addEvents=e,l.getOldestEvents=s,l.getRowCount=u,l.deleteEvents=d}),98);
__d("WAWebMediaPlaybackEventLoggerCache",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){function e(){this.$1=[]}var t=e.prototype;return t.write=function(t){if(Array.isArray(t)){var e;(e=this.$1).push.apply(e,t);return}this.$1.push(t)},t.consume=function(){var e=this.$1;return this.$1=[],e},e})();i.MediaPlaybackEventLoggerCache=e}),66);
__d("WAWebMediaPlaybackEventPersistentQueue",["WALogger","WAWebCRUDOperationsMediaPlaybackEvent","WAWebPromiseQueue","lodash"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=new(o("WAWebPromiseQueue")).PromiseQueue,c=200,d=r("lodash").throttle(function(e){return m(e)},c);function m(t){return u.enqueue(function(){var n=t.consume();if(n.length!==0)return o("WAWebCRUDOperationsMediaPlaybackEvent").addEvents(n).then(function(){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[MediaPlaybackEventPersistentQueue] write success"]))).devConsole(n)}).catch(function(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MediaPlaybackEventPersistentQueue] write failed"]))).devConsole(e).sendLogs("media-playback-event-persistent-queue-write-failed"),t.write(n)})})}l.writePromiseQueue=u,l.WRITE_THROTTLE_INTERVAL=c,l.addToQueue=d}),98);
__d("WAWebFetchOHAIKeyConfigJobQuery.graphql",[],(function(t,n,r,o,a,i){"use strict";var e=(function(){var e={alias:null,args:null,kind:"ScalarField",name:"aead_id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"expiration_date",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"kdf_id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"kem_id",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"key_id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"last_updated_time",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"public_key",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"WAWebFetchOHAIKeyConfigJobQuery",selections:[{alias:null,args:null,concreteType:"XWA2OHAIConfigsResponse",kind:"LinkedField",name:"xwa2_ohai_configurations",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2OHAIConfig",kind:"LinkedField",name:"ohai_configs",plural:!0,selections:[{kind:"RequiredField",field:e,action:"THROW"},{kind:"RequiredField",field:t,action:"THROW"},{kind:"RequiredField",field:n,action:"THROW"},{kind:"RequiredField",field:r,action:"THROW"},{kind:"RequiredField",field:o,action:"THROW"},{kind:"RequiredField",field:a,action:"THROW"},{kind:"RequiredField",field:i,action:"THROW"}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"WAWebFetchOHAIKeyConfigJobQuery",selections:[{alias:null,args:null,concreteType:"XWA2OHAIConfigsResponse",kind:"LinkedField",name:"xwa2_ohai_configurations",plural:!1,selections:[{alias:null,args:null,concreteType:"XWA2OHAIConfig",kind:"LinkedField",name:"ohai_configs",plural:!0,selections:[e,t,n,r,o,a,i],storageKey:null}],storageKey:null}]},params:{id:"29366514836329275",metadata:{},name:"WAWebFetchOHAIKeyConfigJobQuery",operationKind:"query",text:null}}})();a.exports=e}),null);
__d("WAWebFetchOHAIKeyConfigJob",["WATimeUtils","WAWebFetchOHAIKeyConfigJobQuery.graphql","WAWebMexClient","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e!==void 0?e:e=n("WAWebFetchOHAIKeyConfigJobQuery.graphql");function u(){return c.apply(this,arguments)}function c(){return c=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e,t=yield o("WAWebMexClient").fetchQuery(s,{}),n=(e=t.xwa2_ohai_configurations)==null?void 0:e.ohai_configs;return n==null?null:n.reduce(function(e,t){var n=t.expiration_date,r=t.last_updated_time,a=Number.parseInt(n,10),i=Number.parseInt(r,10);return!Number.isSafeInteger(a)||!Number.isSafeInteger(i)||e!=null&&e.expirationDate>a?e:{aeadId:t.aead_id,expirationDate:o("WATimeUtils").castToUnixTime(a),kdfId:t.kdf_id,kemId:t.kem_id,keyId:t.key_id,lastUpdatedTime:o("WATimeUtils").castToUnixTime(i),publicKey:t.public_key}},null)}),c.apply(this,arguments)}l.mexFetchOHAIKeyConfig=u}),98);
__d("WAWebOHAIUserPrefs",["WATimeUtils","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){"use strict";function e(e){r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").UserPrefs.OHAIKeyConfig,e)}function s(){var e=r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").UserPrefs.OHAIKeyConfig);if(e==null||typeof e!="object")return null;var t=e.aeadId,n=e.kdfId,a=e.kemId,i=e.expirationDate,l=e.keyId,s=e.lastUpdatedTime,u=e.publicKey;return typeof i!="number"||typeof t!="number"||typeof n!="number"||typeof a!="number"||typeof l!="number"||typeof s!="number"||typeof u!="string"?null:{aeadId:t,kdfId:n,kemId:a,keyId:l,publicKey:u,expirationDate:o("WATimeUtils").castToUnixTime(i),lastUpdatedTime:o("WATimeUtils").castToUnixTime(s)}}l.setOHAIKeyConfig=e,l.getOHAIKeyConfig=s}),98);
__d("WAWebOHAIKeyConfigProvider",["Hpke","WAHex","WALogger","WATimeUtils","WAWebFetchOHAIKeyConfigJob","WAWebNewsletterRpcUtils","WAWebOHAIUserPrefs","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c=3600;function d(){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var t=yield p();if(t==null)return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[OHAI] Failed to retrieve OHAI key"]))).sendLogs("ohai-retrieve-failed"),null;var n=o("Hpke").AeadID.cast(t.aeadId),r=o("Hpke").KdfID.cast(t.kdfId),a=o("Hpke").KemID.cast(t.kemId),i=t.keyId;if(n==null||r==null||a==null||i==null)return o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[OHAI] Failed to cast OHAI parameters"]))).sendLogs("ohai-cast-failed"),null;try{return{aeadId:n,kdfId:r,kemId:a,keyId:i,expirationDate:t.expirationDate,publicKey:new Uint8Array(o("WAHex").parseHex(t.publicKey))}}catch(e){return o("WALogger").ERROR(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[OHAI] Failed to parse OHAI key config"]))).devConsole(e).sendLogs("ohai-parse-failed"),null}}),m.apply(this,arguments)}function p(){return _.apply(this,arguments)}function _(){return _=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=o("WAWebOHAIUserPrefs").getOHAIKeyConfig();if(e!=null&&f(e))return e;var t=yield o("WAWebNewsletterRpcUtils").runWithBackoff(function(){return o("WAWebFetchOHAIKeyConfigJob").mexFetchOHAIKeyConfig()});return t!=null&&o("WAWebOHAIUserPrefs").setOHAIKeyConfig(t),t}),_.apply(this,arguments)}function f(e){return e.expirationDate-c>o("WATimeUtils").unixTime()}l.provideOHAIKeyConfig=d}),98);
__d("WAWebOHAIClient",["OhaiClient","WALogger","WAWebABProps","WAWebACSNetwork","WAWebHttpExtendedFetch","WAWebOHAIKeyConfigProvider","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=new Set(["https://meta-ohttp-relay-prod.fastly-edge.com/"]);function c(e){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.url,n=e.project,a=e.payload,i=e.headers,l=yield o("WAWebOHAIKeyConfigProvider").provideOHAIKeyConfig();if(l==null)throw o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["No OHAI key config available"]))).sendLogs("failed-to-fetch-ohai-key").tags("ohai"),r("err")("No OHAI key config available");var u=yield m({project:n,url:t,payload:a,headers:i}),c=yield o("OhaiClient").encapsulateRequest(l,u,!0),d=c.ctx,p=c.enc,f=c.encapsulatedRequest,g=_(),h=yield o("WAWebHttpExtendedFetch").extendedFetch(g,{body:f,headers:{"Content-Type":"message/ohttp-req"},method:"POST"});if(!h.ok)return h;var y=yield h.arrayBuffer(),C=new Uint8Array(y);return o("OhaiClient").decapsulateResponse(d,p,C)}),d.apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return p=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var t=e.url,n=e.project,r=e.payload,a=e.headers;if(r==null||n==null)return new Request(t);var i=yield o("WAWebACSNetwork").addACSCredential(n,r);return new Request(t,{body:i,method:"POST",headers:a!=null?a:void 0})}),p.apply(this,arguments)}function _(){var e=o("WAWebABProps").getABPropConfigValue("music_ohai_proxy_url"),t=new URL(e);return f(t),t}function f(t){if(!u.has(t.href))throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Invalid OHAI proxy URL: ",""])),t.href).sendLogs("ohai-invalid-proxy-"+t.href).tags("ohai"),r("err")("Invalid OHAI proxy URL")}l.fetchOHAI=c}),98);
__d("WAWebSNAPLUploadMusicConsumptionLogs",["WALogger","WAWebACSTokenConfig","WAWebBuildConstants","WAWebFileUtils","WAWebMobilePlatforms","WAWebNetworkStatus","WAWebOHAIClient","asyncToGeneratorRuntime"],(function(t,n,r,o,a,i,l){"use strict";var e,s=new URL("https://acs.whatsapp.com/music/reporting"),u=656096963291760 .toString(),c=0x97e965c4439a.toString();function d(e){return m.apply(this,arguments)}function m(){return m=n("asyncToGeneratorRuntime").asyncToGenerator(function*(t){yield r("WAWebNetworkStatus").waitIfOffline();var n=p(t),a=yield o("WAWebOHAIClient").fetchOHAI({url:s,project:o("WAWebACSTokenConfig").ACS_PROJECTS.WA_StatusMusicReporting,payload:n});return o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[SNAPL] logs uploaded via OHAI"]))).devConsole(a),a}),m.apply(this,arguments)}function p(e){var t=new FormData,n=o("WAWebMobilePlatforms").isSMB()?u:c;return t.append("app_id",n),t.append("app_version",o("WAWebBuildConstants").VERSION_STR),t.append("events",o("WAWebFileUtils").createFile([_(e)],"snapl.txt")),t}function _(e){return e.map(function(e){return JSON.stringify(e)}).join("\n")}l.uploadMusicConsumptionLogs=d}),98);
__d("WAWebMediaPlaybackEventUploader",["WAExponentialBackoff","WALogger","WAWebABProps","WAWebCRUDOperationsMediaPlaybackEvent","WAWebNetworkStatus","WAWebPromiseQueue","WAWebSNAPLUploadMusicConsumptionLogs","asyncToGeneratorRuntime","err","lodash"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u,c,d=100,m=3e3,p=new(o("WAWebPromiseQueue")).PromiseQueue,_=r("lodash").throttle(f,m);function f(){return g.apply(this,arguments)}function g(){return g=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield p.enqueue(n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=yield o("WAWebCRUDOperationsMediaPlaybackEvent").getRowCount();if(e===0)return{success:!0,leftover:0};var t=yield b(),n=t.events,a=t.ids,i=n.length;if(i===0)return{success:!0,leftover:0};try{var l=yield h(n);if(!l.ok)throw r("err")("upload failed")}catch(t){return o("WALogger").ERROR(c||(c=babelHelpers.taggedTemplateLiteralLoose(["[MediaPlaybackEventUploader] failed to upload events"]))).devConsole(t),{success:!1,leftover:e}}return yield o("WAWebCRUDOperationsMediaPlaybackEvent").deleteEvents(a),e>i?{success:!0,leftover:e-i}:{success:!0,leftover:0}})),t=e.success,a=e.leftover;if(t&&a>0)return _()}),g.apply(this,arguments)}function h(t){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[MediaPlaybackEventUploader] starting upload"]))).devConsole(t);var a=new AbortController,i=a.signal;return o("WAExponentialBackoff").exponentialBackoff({retries:3,signal:i,minTimeout:1e3},(function(){var e=n("asyncToGeneratorRuntime").asyncToGenerator(function*(e,n){o("WALogger").DEV(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MediaPlaybackEventUploader.upload] attempt # ",""])),n+1),yield r("WAWebNetworkStatus").waitIfOffline();var a=yield o("WAWebSNAPLUploadMusicConsumptionLogs").uploadMusicConsumptionLogs(t);if(a==null)throw r("err")("upload failed");if(a.ok)return o("WALogger").DEV(u||(u=babelHelpers.taggedTemplateLiteralLoose(["[MediaPlaybackEventUploader.upload] success"]))),a;if(y(a))return e(r("err")("upload failed with status code: "+a.status));throw r("err")("upload failed")});return function(t,n){return e.apply(this,arguments)}})())}function y(e){return e.status>=500}function C(){return Math.max(o("WAWebABProps").getABPropConfigValue("ohai_request_kb_size")-1,1)*1e3}function b(){return v.apply(this,arguments)}function v(){return v=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){var e=0,t=yield o("WAWebCRUDOperationsMediaPlaybackEvent").getOldestEvents(d),n=new TextEncoder;return t.reduce(function(t,r){var o=n.encode(JSON.stringify(r.event)).length;return e+o>C()||(e+=o,t.events.push(r.event),t.ids.push(r.id)),t},{events:[],ids:[]})}),v.apply(this,arguments)}l.MAX_BATCH_SIZE=d,l.UPLOAD_THROTTLE_INTERVAL=m,l.uploadQueue=p,l.requestUpload=_}),98);
__d("WAWebMediaPlaybackEventLogger",["WALogger","WAWebMediaPlaybackEventLoggerCache","WAWebMediaPlaybackEventPersistentQueue","WAWebMediaPlaybackEventUploader"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=(function(){function t(e){this.$1=e}var n=t.prototype;return n.log=function(n){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[MediaPlaybackEventLogger][","] log"])),n.required_metadata.media_id).devConsole(n),this.$1.write(n),this.$2()},n.$2=function(){o("WAWebMediaPlaybackEventPersistentQueue").addToQueue(this.$1).then(o("WAWebMediaPlaybackEventUploader").requestUpload).catch(function(e){o("WALogger").ERROR(s||(s=babelHelpers.taggedTemplateLiteralLoose(["[MediaPlaybackEventLogger] Failed to flush logs"]))).devConsole(e).sendLogs("media-playback-event-logger-flush-failed")})},t})(),c=new u(new(o("WAWebMediaPlaybackEventLoggerCache")).MediaPlaybackEventLoggerCache);l.MediaPlaybackEventLoggerImpl=u,l.MediaPlaybackEventLogger=c}),98);
__d("WAWebPsChannelsSnaplEventWamEvent",["WAWebWamCodegenUtils"],(function(t,n,r,o,a,i,l){var e=o("WAWebWamCodegenUtils").defineEvents({PsChannelsSnaplEvent:[6254,{appId:[2,o("WAWebWamCodegenUtils").TYPES.INTEGER],videoEventJson:[1,o("WAWebWamCodegenUtils").TYPES.STRING]},[1,1,1],"private",0]},{PsChannelsSnaplEvent:[]});l.PsChannelsSnaplEventWamEvent=e}),98);
__d("WAWebMediaPlaybackLogFlusher",["WALogger","WAWebCrashlog","WAWebMediaPlaybackEventLogger","WAWebPsChannelsSnaplEventWamEvent","WAWebWamEnumMessageType","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(function(){function t(e,t){this.$1=e,this.$2=t}var n=t.prototype;return n.flushLogs=function(){var e=this.$1.consumeLoggerEvents();switch(this.$2){case o("WAWebWamEnumMessageType").MESSAGE_TYPE.CHANNEL:e.forEach(function(e){new(o("WAWebPsChannelsSnaplEventWamEvent")).PsChannelsSnaplEventWamEvent({appId:0x97e965c4439a,videoEventJson:JSON.stringify({events:e.events,required_metadata:e.required_metadata})}).commit()});break;case o("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS:e.forEach(function(e){o("WAWebMediaPlaybackEventLogger").MediaPlaybackEventLogger.log(e)});break;default:throw o("WAWebCrashlog").upload({reason:"invalid video origin"}),r("err")("Invalid video origin")}},n.discardLogsWithoutFlushing=function(){var t=this.$1.consumeLoggerEvents();t.forEach(function(t){o("WALogger").DEV(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[mediaplaybacklogflusher][","] Discarding events"])),t.required_metadata.media_id).devConsole(t)})},t})();l.WhatsAppMediaPlaybackLogFlusher=s}),98);
__d("WAWebCometVideoPlayerStateMachine",["MediaPlaybackCompoundEventStateMachineLogger","VideoPlayerImplementationEngineVideoElementAPI","VideoPlayerImplementationStateMachine","VideoPlayerImplementationStateMachineState","VideoPlayerImplementationStateMachineStateUncontrolledState","WALogger","WAWebMediaPlaybackLogFlusher","WAWebNoop"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(t){var n=t.initialLoggingMetaData,a=t.initialCoreVideoPlayerMetaData,i=t.debugLogId,l=t.fullscreenControllerRef,s=t.videoEl,c=t.videoLiveTraceRef,d=t.videoPlayerPassiveViewabilityInfo,m=t.metadataProvider,p=t.videoOrigin,_=o("MediaPlaybackCompoundEventStateMachineLogger").createMediaPlaybackCompoundEventStateMachineLogger({debugLogId:i,initialLoggingMetaData:n,initialCoreVideoPlayerMetaData:a,metadataProvider:m}),f=new(o("WAWebMediaPlaybackLogFlusher")).WhatsAppMediaPlaybackLogFlusher(_,p),g=[function(e,t,n){return _.handleStateMachine(e,t,n),f.flushLogs(),!0}],h=o("VideoPlayerImplementationStateMachineState").createVideoPlayerImplementationStateMachineInitialState({alwaysShowCaptions:!1,captionDisplayStyle:null,dimensions:n.dimensions,areCaptionsAutogenerated:!1,isAbrEnabled:!1,playerVersion:"comet_whatsapp_snapl_only",streamingFormat:"progressive",videoPlayerPassiveViewabilityInfo:d}),y=o("VideoPlayerImplementationStateMachine").createVideoPlayerImplementationStateMachineWithStateTransitionHandlers({collectUncontrolledState:u(s,c,l,d),stateTransitionHandlers:g,debugLogId:i,initialState:h,onFatalError:function(n){var t=n instanceof Error?n.message:String(n);o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["[mediaplayback][snapl] Fatal error in SNAPL machine"]))).sendLogs("snapl-fatal-error").devConsole(t)}});return{machine:y,callbacks:o("VideoPlayerImplementationStateMachine").createReactVideoElementCallbacksForStateMachine(y,r("WAWebNoop")),handleReactEffectInit:function(){var e=y.getCurrentState().controlledState.mountState;e==="before_mounted"&&y.dispatch({type:"implementation_mounted"})},handleReactEffectCleanup:function(){y.dispatch({payload:{reason:"react_effect_cleanup"},type:"implementation_unmounted"})}}}function u(e,t,n,r){return function(){return o("VideoPlayerImplementationStateMachineStateUncontrolledState").createVideoPlayerImplementationStateMachineStateUncontrolledState({engineExtrasAPI:null,fullscreenControllerRef:n,videoElementAPI:o("VideoPlayerImplementationEngineVideoElementAPI").createVideoPlayerImplementationEngineVideoElementAPI(e),videoLiveTraceRef:t,videoPlayerPassiveViewabilityInfo:r})}}l.makeCometVideoPlayerStateMachine=s}),98);
__d("videoPlayerUniqueID",["guid"],(function(t,n,r,o,a,i,l){"use strict";function e(e){return"id-vpuid-"+(e!=null?e:r("guid")())}l.default=e}),98);
__d("WAWebCometVideoPlayerUtils",["WAWebNewsletterGatingUtils","WAWebWamEnumMessageType","videoPlayerUniqueID"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t={height:e.clientHeight,width:e.clientWidth};return{accessToken:null,dimensions:t,productAttribution:null,downstreamShareSignalTracking:null,trackingNodes:"",trackingDataEncrypted:"",playerImplementationInstanceCountRef:{current:1},instanceKey:r("videoPlayerUniqueID")()}}function s(e){if(e.getWamMessageType()===o("WAWebWamEnumMessageType").MESSAGE_TYPE.CHANNEL){var t,n=e.interactiveAnnotations,r=n==null?void 0:n.filter(function(e){var t;return((t=e.embeddedContent)==null?void 0:t.embeddedMusic)!=null});if(r!=null&&r.length>0){var a,i=(a=r[0].embeddedContent)==null||(a=a.embeddedMusic)==null?void 0:a.musicContentMediaId;return{mediaId:i,mediaIdString:null}}var l=e.id.remote.user,s=(t=e.serverId)!=null?t:"",u=l+"_"+s;return{mediaId:o("WAWebNewsletterGatingUtils").getNewsletterLoggingMediaID(),mediaIdString:u}}return{mediaId:null,mediaIdString:null}}l.getInitialMetadata=e,l.getChannelMediaMetadataForSNAPL=s}),98);
__d("WAWebFetchMusicEligibleCountries",["WALogger","WAWebACSNetwork","WAWebCountriesUtils","WAWebNetworkStatus","asyncToGeneratorRuntime","err"],(function(t,n,r,o,a,i,l){"use strict";var e,s="8360352280687329",u="https://acs.whatsapp.com/graphql";function c(){return d.apply(this,arguments)}function d(){return d=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield r("WAWebNetworkStatus").waitIfOffline();try{var t=new FormData;t.append("doc_id",s);var n=yield o("WAWebACSNetwork").fetchWithACSCredential({project:"WA_StatusMusic",url:u,data:t});if(n==null)throw r("err")("Failed to fetch music eligible countries");var a=yield n.json(),i=a.data.xwa_music_eligible_countries.reduce(function(e,t){if(typeof t!="string")return e;var n=o("WAWebCountriesUtils").asISOCountryCode(t);return n!=null&&e.add(n),e},new Set);return i}catch(t){throw o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to fetch music eligible countries"]))).devConsole(t),t}}),d.apply(this,arguments)}l.fetchMusicEligibleCountries=c}),98);
__d("WAWebMusicUserPrefs",["WATimeUtils","WAWebCountriesUtils","WAWebUserPrefsKeys","WAWebUserPrefsStore"],(function(t,n,r,o,a,i,l){"use strict";function e(e){var t=o("WATimeUtils").unixTime();r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").UserPrefs.MusicEligibleCountries,{countries:Array.from(e),epoch:t})}function s(){var e=r("WAWebUserPrefsStore").getUser(o("WAWebUserPrefsKeys").UserPrefs.MusicEligibleCountries);if(e==null||typeof e!="object")return null;var t=e.countries,n=e.epoch;return!Array.isArray(t)||typeof n!="number"||o("WATimeUtils").unixTime()-n>o("WATimeUtils").WEEK_SECONDS?null:t.reduce(function(e,t){if(typeof t!="string")return e;var n=o("WAWebCountriesUtils").asISOCountryCode(t);return n!=null&&e.add(n),e},new Set)}l.setMusicEligibleCountries=e,l.getMusicEligibleCountries=s}),98);
__d("WAWebMusicEligibleCountriesProvider",["WALogger","WAWebCountriesUtils","WAWebFetchMusicEligibleCountries","WAWebMusicGatingUtils","WAWebMusicUserPrefs","compactMap"],(function(t,n,r,o,a,i,l){"use strict";var e;function s(){if(!o("WAWebMusicGatingUtils").isStatusMusicReceiverEnabled())return new Set;var t=o("WAWebMusicUserPrefs").getMusicEligibleCountries();return t!=null?t:(o("WAWebFetchMusicEligibleCountries").fetchMusicEligibleCountries().then(o("WAWebMusicUserPrefs").setMusicEligibleCountries).catch(function(t){return o("WALogger").ERROR(e||(e=babelHelpers.taggedTemplateLiteralLoose(["Failed to fetch music eligible countries"]))).devConsole(t)}),u())}var u=function(){return new Set(r("compactMap")(["AS","AU","GU","MP","NZ","PR","US","GB","FR","DE","SE","IT","MX","PT","CZ","BE","CH","LI","ES","IE","LU","MC","GP","GF","RE","YT","MQ","CY","GI","MT","DZ","BF","EG","GH","KE","LS","MW","MA","NA","NG","ZA","SZ","TZ","TN","UG","ZM","ZW","VN","ID","MY","AR","BR","RO","NL","DK","FI","NO","IS","CO","CL","PE","UY","PY","VE","VI","EC","BO","HN","CR","DO","PA","NI","GT","SV","SK","AL","AM","GE","LV","CM","CV","GN","ML","RW","SN","SC","CA","TR","JP","HR","IN","AT","LT","EE","RS","BA","ME","MK","IL","KR","BG","TH","SA","AE","IQ","JO","KW","LB","LY","OM","PS","QA","TJ","YE","IM","JE","GG","AF","BD","KH","LK","NP","PK","RU","KG","UZ","TM","XK","SM","VA","LA","PL","SG","PH","KZ","MN","CX","CC","HM","NF","SB","VU","FJ","FM","NR","PW","KI","WS","TV","CK","TK","TO","NU","JM","TT","AI","AG","AW","BB","BZ","BM","BS","CW","DM","FK","GS","GY","GD","KY","MS","KN","LC","VC","SX","TC","SR","HK","MO","TW","UA","TF","AO","TG","BW","BJ","IO","MZ","SH","PF","WF","PG","MH","PN","BN","FO","SJ","HU","GR","BL","MF","PM","GL"],o("WAWebCountriesUtils").asISOCountryCode))};l.provideMusicEligibleCountries=s,l.getDefaultMusicEligibleCountries=u}),98);
__d("WAWebMusicPlaybackUtils",["WAWebCountriesUtils","WAWebL10NCountryCodes","WAWebUserPrefsMeUser"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t){var n=s();return n!=null&&t.has(n)&&!e.has(n)}function s(){var e=o("WAWebUserPrefsMeUser").getMaybeMePnUser();return e==null?null:o("WAWebCountriesUtils").asISOCountryCode(o("WAWebL10NCountryCodes").getCountryShortcodeByPhone(e.user))}function u(){var e=s();if(e==null)return null;switch(e){case"AC":return"SH";default:return e}}l.canPlaybackMusic=e,l.getUserCountryCode=s,l.getUserCountryCodeForSNAPL=u}),98);
__d("WAWebSNAPLPersistentId",["WAWebPonyfillsCryptoRandomUUID"],(function(t,n,r,o,a,i,l){"use strict";function e(){return r("WAWebPonyfillsCryptoRandomUUID")()}function s(e){return e}l.computeSNAPLPersistentId=e,l.castToSNAPLPersistentId=s}),98);
__d("WAWebSNAPLUserPrefs",["WAWebSNAPLPersistentId","WAWebUserPrefsKeys","WAWebUserPrefsStore","WAWebWamEnumMessageType","err"],(function(t,n,r,o,a,i,l){"use strict";function e(e,t,n){switch(n){case o("WAWebWamEnumMessageType").MESSAGE_TYPE.CHANNEL:r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").UserPrefs.SNAPLNewsLetterPersistentId,{persistentId:e,mediaId:t});break;case o("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS:r("WAWebUserPrefsStore").setUser(o("WAWebUserPrefsKeys").UserPrefs.SNAPLPersistentId,{persistentId:e,mediaId:t});break;default:throw r("err")("Invalid video origin")}}function s(e,t){var n=null;switch(t){case o("WAWebWamEnumMessageType").MESSAGE_TYPE.CHANNEL:n=o("WAWebUserPrefsKeys").UserPrefs.SNAPLNewsLetterPersistentId;break;case o("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS:n=o("WAWebUserPrefsKeys").UserPrefs.SNAPLPersistentId;break;default:throw r("err")("Invalid video origin")}if(n==null)throw r("err")("Invalid video origin");var a=r("WAWebUserPrefsStore").getUser(n);if(a==null||typeof a!="object")return u(e,t);var i=a.persistentId,l=a.mediaId;return typeof i!="string"||typeof l!="string"?u(e,t):o("WAWebSNAPLPersistentId").castToSNAPLPersistentId(i)}function u(t,n){var r=o("WAWebSNAPLPersistentId").computeSNAPLPersistentId();return e(r,t,n),r}l.getSNAPLPersistentId=s}),98);
__d("useWAWebCanPlaybackAudio",["WAWebMsgGetters","WAWebMusicEligibleCountriesProvider","WAWebMusicGatingUtils","WAWebMusicPlaybackUtils","react","useWAWebMsgValues"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useMemo;function u(e){var t=o("useWAWebMsgValues").useMsgValues(e.id,[o("WAWebMsgGetters").getFirstMusicAnnotationEmbeddedContent,o("WAWebMsgGetters").getIsNewsletterMsg,o("WAWebMsgGetters").getIsStatus]),n=t[0],r=t[1],a=t[2],i=c({isNewsletterMsg:r,isStatusMsg:a}),l=o("WAWebMusicEligibleCountriesProvider").provideMusicEligibleCountries();return s(function(){return n==null?!0:i?o("WAWebMusicPlaybackUtils").canPlaybackMusic(n.countryBlocklist,l):!1},[l,n,i])}function c(e){var t=e.isNewsletterMsg,n=e.isStatusMsg;return t?o("WAWebMusicGatingUtils").isStatusMusicReceiverEnabledForNewsletter():n?o("WAWebMusicGatingUtils").isStatusMusicReceiverEnabled():!1}l.useCanPlaybackAudio=u}),98);
__d("useWAWebCometVideoPlayerStateMachine",["CoreVideoPlayerMetaData","WAWebCometVideoPlayerStateMachine","WAWebCometVideoPlayerUtils","WAWebMusicGatingUtils","WAWebMusicPlaybackUtils","WAWebNewsletterGatingUtils","WAWebNoop","WAWebSNAPLUserPrefs","WAWebWamEnumMessageType","WAWebWamMediaMetricUtils","react","useWAWebUnmountSignal"],(function(t,n,r,o,a,i,l){"use strict";var e,s=e||(e=o("react")),u=s.useCallback,c=s.useEffect,d=s.useRef,m=s.useState,p={current:null},_={current:null},f={getCurrent:function(){return null},subscribe:function(){return{remove:r("WAWebNoop")}}},g=function(){return{}},h={StatusViewer:"status_viewer",NewsletterViewer:"whatsapp_channels"},y=function(t){switch(t){case o("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS:return!o("WAWebMusicGatingUtils").isStatusMusicReceiverEnabled();case o("WAWebWamEnumMessageType").MESSAGE_TYPE.CHANNEL:return!o("WAWebNewsletterGatingUtils").isNewsletterVideoPlaybackLoggingEnabled();default:return!0}},C=function(t){switch(t){case o("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS:return h.StatusViewer;case o("WAWebWamEnumMessageType").MESSAGE_TYPE.CHANNEL:return h.NewsletterViewer;default:return""}},b=function(t){switch(t){case o("WAWebWamEnumMessageType").MESSAGE_TYPE.STATUS:return o("WAWebMusicGatingUtils").isStatusMusicReceiverEnabled();case o("WAWebWamEnumMessageType").MESSAGE_TYPE.CHANNEL:return o("WAWebNewsletterGatingUtils").isNewsletterVideoPlaybackLoggingEnabled();default:return!1}};function v(e){var t=e.mediaId,n=e.isCopyrightMuted,a=e.videoOrigin,i=e.mediaIdString,l=r("useWAWebUnmountSignal")(),s=d(null),h=d(n),v=d(null),S=d(null),R=m(function(){return y(a)}),L=R[0],E=R[1],k=m({handleReactEffectInit:r("WAWebNoop"),handleReactEffectCleanup:r("WAWebNoop"),callbacks:null}),I=k[0],T=k[1],D=u(function(e){var n=s.current;if(n!==e){s.current=e;var u=s.current;if(u==null||t==null||!b(a)){T({handleReactEffectInit:r("WAWebNoop"),handleReactEffectCleanup:r("WAWebNoop"),callbacks:null}),t==null&&E(!0);return}var c=o("WAWebSNAPLUserPrefs").getSNAPLPersistentId(t,a),d=o("WAWebCometVideoPlayerUtils").getInitialMetadata(u),m=o("CoreVideoPlayerMetaData").applyDefaultsToCoreVideoPlayerMetaData({loggingConfig:{loggingToSNAPLCreateMetadataProvider:null},subOrigin:"not_specified_please_fix",videoFBID:"0"});v.current=d,S.current=m;var y=o("WAWebCometVideoPlayerStateMachine").makeCometVideoPlayerStateMachine({initialLoggingMetaData:d,initialCoreVideoPlayerMetaData:m,debugLogId:o("WAWebWamMediaMetricUtils").generateMediaEventId().toString(10),videoEl:u,fullscreenControllerRef:p,videoLiveTraceRef:_,videoPlayerPassiveViewabilityInfo:f,metadataProvider:{getErrorMetadata:g,getRequiredMetadata:function(){return{current_watching_module:C(a),media_id:t,tracking_type:"organic",persistent_id:c,media_id_string:i!=null?i:""}},getTagMetadata:function(){return{is_copyright_muted:h.current,country:o("WAWebMusicPlaybackUtils").getUserCountryCodeForSNAPL(),player_sound_on:!u.muted}}},videoOrigin:a}),R=y.callbacks,L=y.handleReactEffectInit,k=y.handleReactEffectCleanup,I=y.machine;l.aborted!==!0&&(T({machine:I,handleReactEffectInit:L,handleReactEffectCleanup:k,callbacks:R}),E(!0))}},[t,l.aborted,a,i]);return c(function(){h.current=n;var e=I.machine,t=v.current,r=S.current;e==null||t==null||r==null||e.dispatch({payload:{loggingMetaData:t,coreVideoPlayerMetaData:r},type:"notify_logging_metadata_change"})},[I.machine,n]),{callbacks:I.callbacks,handleReactEffectInit:I.handleReactEffectInit,handleReactEffectCleanup:I.handleReactEffectCleanup,ready:L,videoElementRefCallback:D}}l.default=v}),98);